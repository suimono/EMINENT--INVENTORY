<!DOCTYPE html>

<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eminent V0.1 - Sistem Inventori Modern</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <link rel="stylesheet" href="%PUBLIC_URL%/admin-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
/*
 * ================================================
 * MODERN CSS THEME - LENGKAP & DISERASIKAN
 * ================================================
 */

/*
 * ================================================
 * MODERN CSS THEME - FINAL (WARNA & ANIMASI)
 * ================================================
 */

:root {
  /* --- WARNA UTAMA --- */
  --hue-primary: 224; /* Biru Modern */
  --hue-gray: 220;    /* Abu-abu Kebiruan */
  
  /* --- AKSSEN SEMANTIK --- */
  --accent-danger: hsl(0, 84%, 60%);
  --accent-success: hsl(145, 63%, 49%);
  --accent-warning: hsl(38, 92%, 50%);
  --shadow-color: hsl(var(--hue-gray), 40%, 20%);

  /* --- LIGHT MODE --- */
  --bg-primary-light: hsl(var(--hue-gray), 30%, 98%);
  --bg-secondary-light: hsl(var(--hue-gray), 30%, 100%);
  --bg-tertiary-light: hsl(var(--hue-gray), 25%, 94%);
  --bg-surface-light: hsl(var(--hue-gray), 20%, 96%);
  --text-primary-light: hsl(var(--hue-gray), 25%, 10%);
  --text-secondary-light: hsl(var(--hue-gray), 15%, 40%);
  --text-tertiary-light: hsl(var(--hue-gray), 15%, 60%);
  --border-strong-light: hsl(var(--hue-gray), 20%, 75%);
  --border-soft-light: hsl(var(--hue-gray), 25%, 88%);
  --accent-primary-light: hsl(var(--hue-primary), 76%, 58%);
  --accent-primary-hover-light: hsl(var(--hue-primary), 76%, 53%);
  --accent-primary-active-light: hsl(var(--hue-primary), 76%, 48%);
  
  /* --- DARK MODE --- */
  --bg-primary-dark: hsl(var(--hue-gray), 15%, 12%); 
  --bg-secondary-dark: hsl(var(--hue-gray), 15%, 18%); 
  --bg-tertiary-dark: hsl(var(--hue-gray), 15%, 24%); 
  --bg-surface-dark: hsl(var(--hue-gray), 15%, 21%);
  --text-primary-dark: hsl(var(--hue-gray), 20%, 98%);
  --text-secondary-dark: hsl(var(--hue-gray), 20%, 75%);
  --text-tertiary-dark: hsl(var(--hue-gray), 20%, 55%);
  --border-strong-dark: hsl(var(--hue-gray), 15%, 40%);
  --border-soft-dark: hsl(var(--hue-gray), 15%, 28%);
  --accent-primary-dark: hsl(var(--hue-primary), 70%, 65%);
  --accent-primary-hover-dark: hsl(var(--hue-primary), 70%, 60%);
  --accent-primary-active-dark: hsl(var(--hue-primary), 70%, 55%);
}

/* ================================================ */
/* --- BASE & UTILITIES --- */
/* ================================================ */

body {
  font-family: 'Inter', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: var(--bg-primary-light);
  color: var(--text-primary-light);
  transition: background-color 0.3s ease, color 0.3s ease;
}
.dark body {
  background-color: var(--bg-primary-dark);
  color: var(--text-primary-dark);
}

/* Custom Scrollbar */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: hsl(var(--hue-gray), 20%, 75%); border-radius: 10px; }
.dark ::-webkit-scrollbar-thumb { background: hsl(var(--hue-gray), 15%, 40%); }
::-webkit-scrollbar-thumb:hover { background: hsl(var(--hue-gray), 20%, 65%); }
.dark ::-webkit-scrollbar-thumb:hover { background: hsl(var(--hue-gray), 15%, 50%); }

/* Utility Classes */
.bg-card { background-color: var(--bg-secondary-light); border: 1px solid var(--border-soft-light); border-radius: 0.75rem; }
.dark .bg-card { background-color: var(--bg-secondary-dark); border-color: var(--border-soft-dark); }
.text-main { color: var(--text-primary-light); }
.dark .text-main { color: var(--text-primary-dark); }
.text-subtle { color: var(--text-secondary-light); }
.dark .text-subtle { color: var(--text-secondary-dark); }
.shadow-custom { box-shadow: 0 4px 12px hsla(var(--shadow-color), 20%, 0%, 0.05); }
.dark .shadow-custom { box-shadow: 0 4px 15px hsla(var(--shadow-color), 0%, 0%, 0.15); }

/* ================================================ */
/* --- FORM ELEMENTS --- */
/* ================================================ */

input, select, textarea {
  background-color: var(--bg-surface-light);
  color: var(--text-primary-light);
  border: 2px solid var(--border-soft-light);
  border-radius: 0.75rem;
  padding: 0.75rem 1rem;
  transition: border-color 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
}
.dark input, .dark select, .dark textarea {
  background-color: var(--bg-surface-dark);
  color: var(--text-primary-dark);
  border-color: var(--border-soft-dark);
}
input::placeholder, textarea::placeholder { color: var(--text-tertiary-light); }
.dark input::placeholder, .dark textarea::placeholder { color: var(--text-tertiary-dark); }

input:focus, select:focus, textarea:focus {
  border-color: var(--accent-primary-light);
  box-shadow: 0 0 0 3px hsla(var(--hue-primary), 76%, 58%, 0.25);
  outline: none;
  background-color: var(--bg-secondary-light);
}
.dark input:focus, .dark select:focus, .dark textarea:focus {
  border-color: var(--accent-primary-dark);
  box-shadow: 0 0 0 3px hsla(var(--hue-primary), 70%, 65%, 0.25);
  background-color: var(--bg-primary-dark);
}

/* ================================================ */
/* --- BUTTONS --- */
/* ================================================ */

.button-base {
  padding: 0.75rem 1.25rem;
  border-radius: 0.75rem;
  font-weight: 600;
  transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
  text-align: center;
  cursor: pointer;
  border: 2px solid transparent;
}

.button-primary { 
  background-color: var(--accent-primary-light);
  color: white;
  box-shadow: 0 4px 12px hsla(var(--hue-primary), 76%, 58%, 0.25);
}
.dark .button-primary {
  background-color: var(--accent-primary-dark);
  box-shadow: 0 4px 12px hsla(var(--hue-primary), 70%, 65%, 0.2);
}
.button-primary:hover {
  background-color: var(--accent-primary-hover-light);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px hsla(var(--hue-primary), 76%, 58%, 0.3);
}
.dark .button-primary:hover {
  background-color: var(--accent-primary-hover-dark);
  box-shadow: 0 6px 16px hsla(var(--hue-primary), 70%, 65%, 0.25);
}

.button-primary:active {
  background-color: var(--accent-primary-active-light);
  transform: translateY(0);
  box-shadow: 0 2px 5px hsla(var(--hue-primary), 76%, 58%, 0.2);
}
.dark .button-primary:active {
  background-color: var(--accent-primary-active-dark);
}

.button-secondary {
  background-color: var(--bg-tertiary-light);
  color: var(--text-secondary-light);
  border-color: var(--border-soft-light);
}
.dark .button-secondary {
  background-color: var(--bg-tertiary-dark);
  color: var(--text-secondary-dark);
  border-color: var(--border-soft-dark);
}
.button-secondary:hover {
  background-color: hsl(var(--hue-gray), 20%, 90%);
  color: var(--text-primary-light);
  border-color: var(--border-strong-light);
}
.dark .button-secondary:hover {
  background-color: hsl(var(--hue-gray), 15%, 28%);
  color: var(--text-primary-dark);
  border-color: var(--border-strong-dark);
}

/* ================================================ */
/* --- KEYFRAMES & ANIMATIONS --- */
/* ================================================ */

/* DIUBAH: Keyframes dibuat lebih halus dengan cubic-bezier */

/* Masuk dengan fade */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Masuk dari bawah + fade */
@keyframes slideInUp {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Masuk dengan zoom + fade */
@keyframes zoomIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

/* Animasi untuk modal */
@keyframes popIn {
  from { opacity: 0; transform: scale(0.9) translateY(-10px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

/* Animasi untuk "typing..." */
@keyframes typingDot {
  0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

/* Animasi berputar */
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* BARU: Kelas Utilitas untuk Animasi */
.animate-fadeIn {
  animation: fadeIn 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
}
.animate-slideInUp {
  animation: slideInUp 0.4s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
}
.animate-zoomIn {
  animation: zoomIn 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
}
.animate-popIn {
  animation: popIn 0.3s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
}
.animate-spin {
  animation: spin 1s linear infinite;
}
.animate-typing-dot {
  animation: typingDot 1.4s infinite ease-in-out both;
}
.animate-typing-dot.delay-1 { animation-delay: 0.16s; }
.animate-typing-dot.delay-2 { animation-delay: 0.32s; }


/* ================================================ */
/* --- ReactTransitionGroup Page Transitions --- */
/* ================================================ */

/* DIUBAH: Menggunakan keyframes yang sudah didefinisikan */
.page-content-enter {
  opacity: 0;
  transform: translateY(15px);
}
.page-content-enter-active {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 300ms cubic-bezier(0.25, 0.8, 0.25, 1), transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1);
}
.page-content-exit {
  opacity: 1;
  transform: translateY(0);
}
.page-content-exit-active {
  opacity: 0;
  transform: translateY(-15px);
  transition: opacity 250ms cubic-bezier(0.25, 0.8, 0.25, 1), transform 250ms cubic-bezier(0.25, 0.8, 0.25, 1);
}

/* ================================================ */
/* --- OTHER COMPONENTS (Sidebar, AI Panel, etc.) --- */
/* ================================================ */

/* AI Chat Panel */
.ai-chat-panel {
  position: fixed; top: 0; right: 0; width: 100%; max-width: 420px; height: 100vh; z-index: 1050;
  background-color: var(--bg-secondary-light); 
  border-left: 1px solid var(--border-soft-light);
  box-shadow: -8px 0 25px hsla(var(--shadow-color), 20%, 0%, 0.1);
  transform: translateX(100%);
  transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  opacity: 0; 
  pointer-events: none;
}
.dark .ai-chat-panel {
  background-color: var(--bg-secondary-dark);
  border-left-color: var(--border-soft-dark);
  box-shadow: -8px 0 25px hsla(var(--shadow-color), 0%, 0%, 0.25);
}
.ai-chat-panel.active {
  transform: translateX(0);
  opacity: 1;
  pointer-events: auto;
}

/* Floating AI Button */
.floating-ai-button {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  background-color: var(--accent-primary-light);
  color: white;
  padding: 0.875rem;
  border-radius: 50%;
  box-shadow: 0 6px 18px hsla(var(--hue-primary), 70%, 55%, 0.4);
  z-index: 1000;
  cursor: pointer;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
}
.dark .floating-ai-button {
  background-color: var(--accent-primary-dark);
  box-shadow: 0 6px 18px hsla(var(--hue-primary), 65%, 60%, 0.4);
}
.floating-ai-button:hover {
  transform: translateY(-3px) scale(1.05);
}
        @media (max-width: 768px) { /* Responsive adjustments for floating button */
            .floating-ai-button {
                bottom: 1.5rem;
                right: 1.5rem;
                padding: 0.75rem; /* 12px */
            }
            .floating-ai-button svg {
                width: 1.5rem; /* 24px */
                height: 1.5rem; /* 24px */
            }
            .ai-chat-panel { /* Full width on mobile */
                width: 100%;
                max-width: 100%;
                border-left: none;
            }
        }

    </style>
</head>
<body> 
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, createContext, useContext, useMemo } = React; // Added useMemo

        // START Polyfill Definition for ReactTransitionGroup
        if (typeof window.ReactTransitionGroup === 'undefined') {
            window.ReactTransitionGroup = {};
        }
        if (typeof window.ReactTransitionGroup.CSSTransition === 'undefined') {
            window.ReactTransitionGroup.CSSTransition = ({ children, classNames: propClassNames, timeout, in: inProp = true, unmountOnExit, onExited, nodeRef: providedNodeRef }) => {
                const [show, setShow] = useState(inProp);
                const internalNodeRef = useRef(null);
                const nodeRef = providedNodeRef || internalNodeRef;

                // Define cNames at the component scope using useMemo, derived from the prop 'propClassNames'
                const cNames = useMemo(() => {
                    return typeof propClassNames === 'string' ? {
                        enter: `${propClassNames}-enter`,
                        enterActive: `${propClassNames}-enter-active`,
                        enterDone: `${propClassNames}-enter-done`,
                        exit: `${propClassNames}-exit`,
                        exitActive: `${propClassNames}-exit-active`,
                        exitDone: `${propClassNames}-exit-done`,
                    } : propClassNames;
                }, [propClassNames]);

                useEffect(() => { setShow(inProp); }, [inProp]);

                useEffect(() => {
                    const currentEl = nodeRef.current;
                    if (!currentEl) return;

                    const applyClasses = (type) => {
                        // Clean up all possible transition states before applying the new one
                        currentEl.classList.remove(cNames.enter, cNames.enterActive, cNames.enterDone, cNames.exit, cNames.exitActive, cNames.exitDone);
                        currentEl.classList.add(cNames[type]);
                        void currentEl.offsetWidth; // Force reflow
                        requestAnimationFrame(() => {
                            if (nodeRef.current) {
                                nodeRef.current.classList.add(cNames[`${type}Active`]);
                            }
                        });
                    };

                    const cleanupClasses = (type) => {
                         if (nodeRef.current) {
                              nodeRef.current.classList.remove(cNames[type], cNames[`${type}Active`]);
                              nodeRef.current.classList.add(cNames[`${type}Done`]);
                         }
                    };
                    
                    let timeoutId;
                    if (show) { 
                        applyClasses('enter');
                        timeoutId = setTimeout(() => {
                            cleanupClasses('enter');
                            if (nodeRef.current && cNames.enterDone) { // Clean up enterDone after animation
                                nodeRef.current.classList.remove(cNames.enterDone);
                            }
                        }, timeout);
                    } else { 
                        if (currentEl.offsetParent !== null || currentEl.isConnected) { // Check if element is in DOM
                            applyClasses('exit');
                            timeoutId = setTimeout(() => {
                                cleanupClasses('exit');
                                if (onExited) {
                                    onExited(); 
                                }
                                if (nodeRef.current && cNames.exitDone) { // Clean up exitDone after animation
                                     nodeRef.current.classList.remove(cNames.exitDone);
                                }
                            }, timeout);
                        } else if (unmountOnExit && onExited) {
                            onExited();
                        }
                    }
                    return () => clearTimeout(timeoutId);

                }, [show, cNames, timeout, nodeRef, onExited, unmountOnExit]); 
                
                if (!show && unmountOnExit) {
                    const isAnimatingExit = nodeRef.current && (nodeRef.current.classList.contains(cNames.exit) || nodeRef.current.classList.contains(cNames.exitActive));
                    if (!isAnimatingExit) {
                        return null;
                    }
                }

                const child = React.Children.only(children);
                return React.cloneElement(child, { ref: nodeRef });
            };
        }
        if (typeof window.ReactTransitionGroup.TransitionGroup === 'undefined') {
            window.ReactTransitionGroup.TransitionGroup = ({ children, component: Component = 'div', ...props }) => {
                if (Component === null) return <>{children}</>;
                return <Component {...props}>{children}</Component>;
            };
        }
        // END Polyfill Definition
        const { CSSTransition, TransitionGroup } = window.ReactTransitionGroup;

        const AppContext = createContext();

        // --- LocalStorage Helper Functions ---
        const getAssets = () => { 
            try { 
                const a = localStorage.getItem('assetsV3'); 
                return a ? JSON.parse(a) : []; 
            } catch (e) { console.error("LS Error: getAssets", e); return []; } 
        };
        const saveAssets = (a) => { try { localStorage.setItem('assetsV3', JSON.stringify(a)); } catch (e) { console.error("LS Error: saveAssets", e); } };
        
        const USERS_STORAGE_KEY = 'usersV3';
        const getStoredUsers = () => {
            try {
                const u = localStorage.getItem(USERS_STORAGE_KEY);
                if (u) return JSON.parse(u);
                // Default users if none are stored
                const defaultUsers = [
                    { email: "admin@eminent.com", password: "adminpassword", role: "admin", name: "Admin Utama", position: "System Administrator", avatarUrl: `https://placehold.co/100x100/2563EB/FFFFFF?text=AU` }, // Blue placeholder
                    { email: "user@eminent.com", password: "userpassword", role: "user", name: "Pengguna Standar", position: "Staff", avatarUrl: `https://placehold.co/100x100/8B5CF6/FFFFFF?text=PS` } // Purple placeholder
                ];
                localStorage.setItem(USERS_STORAGE_KEY, JSON.stringify(defaultUsers));
                return defaultUsers;
            } catch (e) { console.error("LS Error: getStoredUsers", e); return []; }
        };
        const saveUsers = (u) => { try { localStorage.setItem(USERS_STORAGE_KEY, JSON.stringify(u)); } catch (e) { console.error("LS Error: saveUsers", e); }};
        
        const getProfile = () => { 
            try { 
                const p = localStorage.getItem('userProfileV3'); 
                return p ? JSON.parse(p) : { 
                    name: 'Admin Eminent', 
                    email: 'admin@eminent.com', 
                    avatarUrl: `https://placehold.co/100x100/2563EB/FFFFFF?text=AE`, // Blue placeholder
                    position: 'Administrator', 
                    logoUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 40" width="180" height="40"><rect width="180" height="40" fill="hsl(210, 70%, 55%)" rx="5" ry="5" /><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-family="Inter, sans-serif" font-size="20" font-weight="bold" fill="white">EMINENT</text></svg>' 
                }; 
            } catch (e) { console.error("LS Error: getProfile", e); return {}; }
        };
        const saveProfile = (p) => { try { localStorage.setItem('userProfileV3', JSON.stringify(p)); } catch (e) { console.error("LS Error: saveProfile", e); }};

        // --- SVG Icons (Heroicons v2 style) ---
  // PERMINTAAN MAAF: Ini kode yang seharusnya saya berikan dari awal.
// Gaya visual setiap ikon diubah menjadi lebih modern (Duotone/Solid)
// dan tetap fleksibel agar bisa diubah ukurannya via className.

const IconDashboard = (props) => (
  // DIUBAH: Gaya diubah menjadi solid fill untuk tampilan lebih modern
  <svg 
    xmlns="http://www.w3.org/2000/svg" 
    viewBox="0 0 24 24" 
    fill="currentColor" // Menggunakan fill, bukan stroke
    className={`w-5 h-5 ${props.className || ''}`}
    {...props}
  >
    <path d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25A2.25 2.25 0 0113.5 8.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
  </svg>
);

const IconAssetList = (props) => (
  // DIUBAH: Garis dipertebal
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
  </svg>
);

const IconVerify = (props) => (
  // DIUBAH: Gaya diubah menjadi Duotone
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}>
    <path className="opacity-40" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
    <path strokeLinecap="round" strokeLinejoin="round" d="M9 12.75L11.25 15 15 9.75" />
  </svg>
);

const IconReport = (props) => (
  // DIUBAH: Gaya diubah menjadi Duotone
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}>
    <path className="opacity-40" strokeLinecap="round" strokeLinejoin="round" d="M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
    <path strokeLinecap="round" strokeLinejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5M8.25 21V18" />
  </svg>
);

const IconSettings = (props) => (
  // DIUBAH: Gaya diubah menjadi Duotone
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z" />
    <path className="opacity-50" strokeLinecap="round" strokeLinejoin="round" d="M9.594 3.94c.09-.542.56-1.003 1.11-.962a8.25 8.25 0 015.36 5.36c.041.55.52 1.021.962 1.11.542.09.962.56 1.003 1.11C21.431 13.37 18.37 16.43 14.056 17.445c-.55.04-.962.52-1.11.962-.09.542-.56 1.003-1.11.962a8.25 8.25 0 01-5.36-5.36c-.041-.55-.52-1.021-.962-1.11-.542-.09-.962-.56-1.003-1.11C1.569 10.63 4.63 7.57 8.944 6.555c.55-.04.962-.52 1.11-.962z" />
  </svg>
);

const IconLogout = (props) => (
  // DIUBAH: Garis dipertebal
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" />
  </svg>
);

// --- Ikon lainnya juga diperbarui agar fleksibel dan modern ---

const IconChevronDown = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={3} stroke="currentColor" className={`w-4 h-4 transition-transform duration-200 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>;
const IconChevronUp = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={3} stroke="currentColor" className={`w-4 h-4 transition-transform duration-200 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" /></svg>;
const IconPlus = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>;
const IconMapPin = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path className="opacity-40" fill="currentColor" strokeLinecap="round" strokeLinejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /><path strokeLinecap="round" strokeLinejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /></svg>;
const IconSearch = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /></svg>;
const IconSun = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.64 5.64M12 20.25a8.25 8.25 0 100-16.5 8.25 8.25 0 000 16.5z" /></svg>;
const IconMoon = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" className={`w-5 h-5 ${props.className || ''}`} {...props}><path d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" /></svg>;
const IconBell = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0" /></svg>;
const IconArrowLeft = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" /></svg>;
const IconUpload = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-8 h-8 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" /></svg>;
const IconQrCode = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 013.75 9.375v-4.5zM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 01-1.125-1.125v-4.5zM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0113.5 9.375v-4.5z" /><path strokeLinecap="round" strokeLinejoin="round" d="M17.25 6.75h.008v.008h-.008V6.75zM17.25 16.5h.008v.008h-.008v-.008zM5.25 16.5h.008v.008H5.25v-.008zM9 18.75h-.008v.008H9v-.008zM9 6.75h.008v.008H9V6.75z" /></svg>;
const IconDownload = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>;
const IconAiAssistant = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624l.259 1.035L18 21.75l-.844.259a3.375 3.375 0 00-2.455 2.455l-1.036.259L13.5 24l.259-1.035a3.375 3.375 0 002.456-2.456l1.035-.259z" /></svg>;
const IconRobotFace = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M11.485 7.5A2.25 2.25 0 0113.735 9.75V10.5a2.25 2.25 0 01-4.5 0V9.75a2.25 2.25 0 012.235-2.25H11.485z" /><path strokeLinecap="round" strokeLinejoin="round" d="M6.75 12a.75.75 0 01.75-.75h9a.75.75 0 010 1.5h-9a.75.75 0 01-.75-.75zM4.5 15.75A2.25 2.25 0 016.75 13.5h10.5a2.25 2.25 0 012.25 2.25v.75A2.25 2.25 0 0117.25 18.75H6.75A2.25 2.25 0 014.5 16.5v-.75z" /><path className="opacity-40" strokeLinecap="round" strokeLinejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /><path strokeLinecap="round" strokeLinejoin="round" d="M9.75 15.75H14.25" /></svg>;
const IconSend = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" /></svg>;
const IconSpinner = (props) => <svg className={`animate-spin h-5 w-5 text-white ${props.className || ''}`} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" {...props}><circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle><path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>;
const IconClose = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>;
const IconBoxArrowOut = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M3 3v1.5M3 21v-6m0 0l2.77-.693a9 9 0 016.208.682l.108.054a9 9 0 006.086.71l3.114-.732a48.524 48.524 0 01-.005-10.499l-3.11.732a9 9 0 01-6.085-.711l-.108-.054a9 9 0 00-6.208-.682L3 4.5M3 15V4.5" /></svg>;
const IconArchiveBoxArrowDown = (props) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={`w-5 h-5 ${props.className || ''}`} {...props}><path strokeLinecap="round" strokeLinejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 013.75 9.375v-4.5zM19.5 19.5V7.5M19.5 7.5H4.5m15 0V4.875c0-.621-.504-1.125-1.125-1.125h-4.5c-.621 0-1.125.504-1.125 1.125v2.625m6.75 0H9.75m0 0H3.75m0 0V19.5m0 0h15.75M12 16.5l3-3m0 0l-3-3m3 3H6.75" /></svg>;
        // --- Komponen Modal (Modernized) ---
        function Modal({ children, onClose, title, size = "max-w-md" }) {
            return (
                <div className="fixed inset-0 bg-black/70 backdrop-blur-md flex items-center justify-center z-[1050] p-4 animate-modal-pop-in">
                    <div className={`bg-card p-6 rounded-xl shadow-2xl ${size} w-full border border-soft glassmorphic`}>
                        <header className="flex items-center justify-between mb-5">
                            <h3 className="text-xl font-semibold text-main">{title}</h3>
                            <button onClick={onClose} className="p-1.5 rounded-full text-muted hover:bg-surface hover:text-main transition-colors">
                                <IconClose />
                            </button>
                        </header>
                        {children}
                    </div>
                </div>
            );
        }
        
        function MessageBox({ message, onClose }) {
            if (!message) return null;
            return (
                <Modal onClose={onClose} title="Pemberitahuan" size="max-w-sm">
                    <p className="text-subtle text-base mb-6">{message}</p>
                    <div className="flex justify-end">
                        <button onClick={onClose} className="button-base button-primary">OK</button>
                    </div>
                </Modal>
            );
        }

        function LogoutOptionsModal({ onSelectOption, onClose }) {
          return (
    <Modal onClose={onClose} title="Konfirmasi Keluar" size="max-w-md">
        <div className="space-y-6">
            {/* Icon and Message */}
            <div className="text-center space-y-4">
                <div className="inline-flex p-4 bg-gradient-to-r from-amber-100 to-orange-100 rounded-full shadow-lg">
                    <svg className="w-8 h-8 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z" />
                    </svg>
                </div>
                <div>
                    <h4 className="text-xl font-bold text-slate-800 mb-2">Konfirmasi Keluar</h4>
                    <p className="text-slate-600 text-base leading-relaxed">
                        Anda akan meninggalkan halaman ini. Kemana Anda ingin kembali?
                    </p>
                </div>
            </div>

            {/* Action Buttons */}
            <div className="space-y-3">
                <button 
                    onClick={() => onSelectOption('register')} 
                    className="group w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white font-semibold rounded-2xl transition-all duration-300 hover:scale-105 hover:shadow-xl hover:shadow-blue-500/30"
                >
                    <svg className="w-5 h-5 group-hover:scale-110 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
                    </svg>
                    <span>Kembali ke Register</span>
                </button>

                <button 
                    onClick={() => onSelectOption('login')} 
                    className="group w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white font-semibold rounded-2xl transition-all duration-300 hover:scale-105 hover:shadow-xl hover:shadow-emerald-500/30"
                >
                    <svg className="w-5 h-5 group-hover:scale-110 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                    </svg>
                    <span>Kembali ke Login</span>
                </button>

                <button 
                    onClick={onClose} 
                    className="group w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-slate-100 to-slate-200 hover:from-red-100 hover:to-red-200 text-slate-700 hover:text-red-700 font-semibold rounded-2xl transition-all duration-300 hover:scale-105 border border-slate-200 hover:border-red-200 hover:shadow-lg"
                >
                    <svg className="w-5 h-5 group-hover:scale-110 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                    </svg>
                    <span>Batal</span>
                </button>
            </div>
        </div>
    </Modal>
);
        }

        function ProfileEditModal({ userProfile, onSave, onClose, setMessage }) {
            const [name, setName] = useState(userProfile.name);
            const [email, setEmail] = useState(userProfile.email);
            const [avatarUrl, setAvatarUrl] = useState(userProfile.avatarUrl);
            const [position, setPosition] = useState(userProfile.position || '');

            const handleSave = () => {
                if (!name || !email) { setMessage('Nama dan Email tidak boleh kosong.'); return; }
                onSave({ name, email, avatarUrl, position, logoUrl: userProfile.logoUrl });
                onClose();
            };
            return (
              <Modal onClose={onClose} title="Edit Profil Pengguna" size="max-w-lg">
                  <div className="space-y-6">
                      {/* Avatar Preview */}
                      {avatarUrl && (
                          <div className="flex justify-center">
                              <div className="relative">
                                  <img 
                                      src={avatarUrl} 
                                      alt="Avatar Preview" 
                                      className="w-20 h-20 rounded-full object-cover border-2 border-gray-200 shadow-sm" 
                                      onError={(e) => {
                                          e.target.onerror = null;
                                          e.target.src = 'https://placehold.co/80x80/E0E7FF/4F46E5?text=ðŸ‘¤';
                                      }} 
                                  />
                                  <div className="absolute -bottom-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center">
                                      <span className="text-white text-xs">ðŸ“·</span>
                                  </div>
                              </div>
                          </div>
                      )}

                      {/* Form Fields */}
                      <div className="space-y-4">
                          <div>
                              <label htmlFor="profileName" className="block text-sm font-medium text-gray-700 mb-2">
                                  Nama Lengkap
                              </label>
                              <input 
                                  type="text" 
                                  id="profileName" 
                                  className="
                                      w-full px-3 py-2 border border-gray-300 rounded-lg
                                      focus:ring-2 focus:ring-blue-500 focus:border-blue-500
                                      transition-colors duration-200 outline-none
                                  " 
                                  placeholder="Masukkan nama lengkap"
                                  value={name} 
                                  onChange={(e) => setName(e.target.value)} 
                              />
                          </div>

                          <div>
                              <label htmlFor="profileEmail" className="block text-sm font-medium text-gray-700 mb-2">
                                  Alamat Email
                              </label>
                              <input 
                                  type="email" 
                                  id="profileEmail" 
                                  className="
                                      w-full px-3 py-2 border border-gray-300 rounded-lg
                                      focus:ring-2 focus:ring-blue-500 focus:border-blue-500
                                      transition-colors duration-200 outline-none
                                  " 
                                  placeholder="contoh@email.com"
                                  value={email} 
                                  onChange={(e) => setEmail(e.target.value)} 
                              />
                          </div>

                          <div>
                              <label htmlFor="profilePosition" className="block text-sm font-medium text-gray-700 mb-2">
                                  Jabatan
                              </label>
                              <input 
                                  type="text" 
                                  id="profilePosition" 
                                  className="
                                      w-full px-3 py-2 border border-gray-300 rounded-lg
                                      focus:ring-2 focus:ring-blue-500 focus:border-blue-500
                                      transition-colors duration-200 outline-none
                                  " 
                                  placeholder="Contoh: Manajer, Staff IT" 
                                  value={position} 
                                  onChange={(e) => setPosition(e.target.value)} 
                              />
                          </div>

                          <div>
                              <label htmlFor="profileAvatar" className="block text-sm font-medium text-gray-700 mb-2">
                                  URL Avatar
                              </label>
                              <input 
                                  type="text" 
                                  id="profileAvatar" 
                                  className="
                                      w-full px-3 py-2 border border-gray-300 rounded-lg
                                      focus:ring-2 focus:ring-blue-500 focus:border-blue-500
                                      transition-colors duration-200 outline-none
                                  " 
                                  placeholder="https://example.com/avatar.png" 
                                  value={avatarUrl} 
                                  onChange={(e) => setAvatarUrl(e.target.value)} 
                              />
                          </div>
                      </div>

                      {/* Tips */}
                      <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
                          <div className="flex items-start space-x-2">
                              <span className="text-blue-500 text-sm">ðŸ’¡</span>
                              <div className="text-sm text-blue-700">
                                  <p className="font-medium mb-1">Tips foto profil:</p>
                                  <p className="text-blue-600">Gunakan foto dengan kualitas baik, ukuran minimal 200x200px</p>
                              </div>
                          </div>
                      </div>
                  </div>

                  {/* Action Buttons */}
                  <div className="flex justify-end space-x-3 mt-8 pt-4 border-t border-gray-200">
                      <button 
                          onClick={onClose} 
                          className="
                              px-4 py-2 border border-gray-300 text-gray-700 rounded-lg
                              hover:bg-gray-50 transition-colors duration-200
                          "
                      >
                          Batal
                      </button>
                      <button 
                          onClick={handleSave} 
                          className="
                              px-6 py-2 bg-blue-600 text-white rounded-lg
                              hover:bg-blue-700 transition-colors duration-200
                          "
                      >
                          Simpan Perubahan
                      </button>
                  </div>
              </Modal>
          );
        }

        
        
 function AiChatInterface({ isOpen, onClose }) {
    const [messages, setMessages] = useState([{ 
        id: Date.now(), 
        sender: 'ai', 
        text: 'Halo! Saya Asisten AI Eminent. Ada yang bisa saya bantu dengan manajemen aset Anda?',
        timestamp: new Date()
    }]);
    const [inputText, setInputText] = useState('');
    const [isLoading, setIsLoading] = useState(false);
    const [chatHistory, setChatHistory] = useState([]); 
    const messagesEndRef = useRef(null);
    const inputRef = useRef(null);

    const scrollToBottom = () => { 
        messagesEndRef.current?.scrollIntoView({ behavior: "smooth" }); 
    };
    
    useEffect(scrollToBottom, [messages]);
    useEffect(() => { 
        if (isOpen && inputRef.current) { 
            setTimeout(() => inputRef.current.focus(), 100); 
        } 
    }, [isOpen]);

    const addMessageToDisplay = (text, sender, isTyping = false) => {
        setMessages(prevMessages => [...prevMessages, { 
            id: Date.now() + Math.random(), 
            sender, 
            text, 
            isTyping,
            timestamp: new Date()
        }]);
    };

    const handleSendMessage = async () => {
        if (!inputText.trim()) return;
        const userMessageText = inputText;
        addMessageToDisplay(userMessageText, 'user');
        setInputText('');
        
        const currentConversation = [
            ...chatHistory,
            { role: "user", parts: [{ text: userMessageText }] }
        ];

        setIsLoading(true);
        addMessageToDisplay('', 'ai', true); // Typing indicator

        const apiKey = "AIzaSyCm3eOkBmXFVWA8DHKccfJ-TvRihC_FKtQ"; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;
        
        const payload = {
            contents: currentConversation,
        };
        
        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            setMessages(prev => prev.filter(msg => !msg.isTyping)); 

            if (!response.ok) {
                const errorData = await response.json().catch(() => ({ error: { message: "Gagal memproses respons error dari AI."} }));
                console.error("AI API Error Data:", errorData);
                addMessageToDisplay(`Error ${response.status}: ${errorData?.error?.message || response.statusText}`, 'ai');
                setIsLoading(false);
                return;
            }
            
            const result = await response.json();

            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const aiResponseText = result.candidates[0].content.parts[0].text;
                
                // Typing animation simulation
                setTimeout(() => {
                    addMessageToDisplay(aiResponseText, 'ai');
                    setChatHistory(prev => [...prev, 
                        { role: "user", parts: [{ text: userMessageText }] }, 
                        { role: "model", parts: [{ text: aiResponseText }] }
                    ]);
                }, 800);
            } else {
                console.warn("AI Response structure unexpected:", result);
                addMessageToDisplay("Tidak ada respons valid dari AI atau format respons tidak dikenal.", 'ai');
            }
        } catch (error) {
            setMessages(prev => prev.filter(msg => !msg.isTyping));
            console.error("AI Chat Fetch Error:", error);
            addMessageToDisplay(`Gagal terhubung ke layanan AI: ${error.message}. Pastikan endpoint dan koneksi benar.`, 'ai');
        } finally {
            setIsLoading(false);
        }
    };

return (
    <div className={`ai-chat-panel ${isOpen ? 'active' : ''}`} style={{
        position: 'fixed',
        right: isOpen ? '0' : '-400px',
        top: '0',
        width: '400px',
        height: '100vh',
        background: 'linear-gradient(152deg, rgba(15, 23, 42, 0.98) 0%, rgba(30, 41, 59, 0.98) 100%)',
        backdropFilter: 'blur(24px)',
        borderLeft: '1px solid rgba(148, 163, 184, 0.12)',
        boxShadow: isOpen ? '-16px 0 60px rgba(0, 0, 0, 0.4)' : 'none',
        display: 'flex',
        flexDirection: 'column',
        transition: 'all 0.4s cubic-bezier(0.16, 1, 0.3, 1)',
        zIndex: 1000,
        overflow: 'hidden'
    }}>
        {/* Header with Glass Morphism Effect */}
        <header style={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'space-between',
            padding: '18px 24px',
            background: 'linear-gradient(135deg, rgba(59, 130, 246, 0.12) 0%, rgba(147, 51, 234, 0.12) 100%)',
            borderBottom: '1px solid rgba(148, 163, 184, 0.08)',
            position: 'sticky',
            top: '0',
            zIndex: '10',
            backdropFilter: 'blur(12px)'
        }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                {/* AI Avatar with Holographic Effect */}
                <div style={{
                    width: '42px',
                    height: '42px',
                    background: 'linear-gradient(135deg, #3B82F6 0%, #9333EA 100%)',
                    borderRadius: '50%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    position: 'relative',
                    boxShadow: '0 0 20px rgba(59, 130, 246, 0.3)'
                }}>
                    <IconRobotFace style={{ color: 'white', fontSize: '22px' }} />
                    {/* Holographic rings */}
                    <div style={{
                        position: 'absolute',
                        inset: '-4px',
                        borderRadius: '50%',
                        border: '2px solid rgba(59, 130, 246, 0.4)',
                        opacity: '0',
                        animation: 'hologramPulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite'
                    }}></div>
                    <div style={{
                        position: 'absolute',
                        inset: '-8px',
                        borderRadius: '50%',
                        border: '1px solid rgba(147, 51, 234, 0.4)',
                        opacity: '0',
                        animation: 'hologramPulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        animationDelay: '0.5s'
                    }}></div>
                </div>
                <div>
                    <h3 style={{
                        fontSize: '18px',
                        fontWeight: '600',
                        background: 'linear-gradient(135deg, #F8FAFC 0%, #E2E8F0 100%)',
                        backgroundClip: 'text',
                        WebkitBackgroundClip: 'text',
                        WebkitTextFillColor: 'transparent',
                        margin: '0',
                        lineHeight: '1.2',
                        letterSpacing: '0.2px'
                    }}>
                        Eminent AI Assistant
                    </h3>
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: '6px',
                        marginTop: '4px'
                    }}>
                        <div style={{
                            width: '8px',
                            height: '8px',
                            borderRadius: '50%',
                            background: '#10B981',
                            boxShadow: '0 0 8px rgba(16, 185, 129, 0.5)'
                        }}></div>
                        <p style={{
                            fontSize: '12px',
                            color: '#94A3B8',
                            margin: '0',
                            fontWeight: '400'
                        }}>
                            Online â€¢ Ready to help
                        </p>
                    </div>
                </div>
            </div>
            <button 
                onClick={onClose}
                style={{
                    width: '36px',
                    height: '36px',
                    borderRadius: '10px',
                    border: '1px solid rgba(148, 163, 184, 0.15)',
                    background: 'rgba(203, 213, 225, 0.08)',
                    color: '#94A3B8',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    cursor: 'pointer',
                    transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',
                    backdropFilter: 'blur(8px)',
                    transform: 'scale(1)'
                }}
                onMouseEnter={(e) => {
                    e.target.style.background = 'rgba(239, 68, 68, 0.15)';
                    e.target.style.borderColor = 'rgba(239, 68, 68, 0.3)';
                    e.target.style.color = '#EF4444';
                    e.target.style.transform = 'scale(1.1)';
                    e.target.style.boxShadow = '0 0 0 4px rgba(239, 68, 68, 0.1)';
                }}
                onMouseLeave={(e) => {
                    e.target.style.background = 'rgba(203, 213, 225, 0.08)';
                    e.target.style.borderColor = 'rgba(148, 163, 184, 0.15)';
                    e.target.style.color = '#94A3B8';
                    e.target.style.transform = 'scale(1)';
                    e.target.style.boxShadow = 'none';
                }}
                aria-label="Close chat"
            >
                <IconClose style={{ transition: 'transform 0.3s ease' }} />
            </button>
        </header>

        {/* Messages Container with Subtle Gradient */}
        <div style={{
            flex: '1',
            overflowY: 'auto',
            padding: '24px',
            display: 'flex',
            flexDirection: 'column',
            gap: '20px',
            background: 'linear-gradient(rgba(15, 23, 42, 0.2) 0%, rgba(15, 23, 42, 0.8) 100%)',
            scrollbarWidth: 'thin',
            scrollbarColor: 'rgba(148, 163, 184, 0.3) transparent'
        }}>
            {messages.map((msg, index) => (
                <div 
                    key={msg.id} 
                    style={{
                        display: 'flex',
                        justifyContent: msg.sender === 'user' ? 'flex-end' : 'flex-start',
                        animation: `messageSlideIn 0.5s cubic-bezier(0.2, 0, 0.1, 1) ${index * 0.08}s both`
                    }}
                >
                    <div style={{
                        maxWidth: '90%',
                        display: 'flex',
                        flexDirection: msg.sender === 'user' ? 'row-reverse' : 'row',
                        alignItems: 'flex-end',
                        gap: '10px'
                    }}>
                        {/* Avatar */}
                        {msg.sender === 'ai' && (
                            <div style={{
                                width: '32px',
                                height: '32px',
                                borderRadius: '50%',
                                background: 'linear-gradient(135deg, #3B82F6 0%, #9333EA 100%)',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                flexShrink: '0',
                                boxShadow: '0 2px 8px rgba(59, 130, 246, 0.3)'
                            }}>
                                <IconRobotFace style={{ color: 'white', fontSize: '16px' }} />
                            </div>
                        )}

                        {/* Message Bubble */}
                        <div style={{
                            padding: msg.isTyping ? '14px 18px' : '16px 20px',
                            borderRadius: msg.sender === 'user' 
                                ? '18px 18px 4px 18px' 
                                : '18px 18px 18px 4px',
                            background: msg.sender === 'user' 
                                ? 'linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%)'
                                : msg.isTyping 
                                    ? 'rgba(148, 163, 184, 0.12)'
                                    : 'rgba(248, 250, 252, 0.08)',
                            color: msg.sender === 'user' ? '#FFFFFF' : '#F8FAFC',
                            fontSize: '15px',
                            lineHeight: '1.5',
                            border: msg.sender === 'ai' ? '1px solid rgba(148, 163, 184, 0.08)' : 'none',
                            backdropFilter: 'blur(8px)',
                            boxShadow: msg.sender === 'user' 
                                ? '0 6px 20px rgba(59, 130, 246, 0.25)'
                                : '0 4px 12px rgba(0, 0, 0, 0.08)',
                            position: 'relative',
                            overflow: 'hidden',
                            transition: 'transform 0.2s ease, box-shadow 0.2s ease'
                        }}>
                            {msg.isTyping ? (
                                <div style={{
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '6px',
                                    padding: '4px 0'
                                }}>
                                    {[0, 0.2, 0.4].map((delay) => (
                                        <div key={delay} style={{
                                            width: '8px',
                                            height: '8px',
                                            borderRadius: '50%',
                                            background: '#94A3B8',
                                            animation: 'typingDot 1.6s ease-in-out infinite',
                                            animationDelay: `${delay}s`
                                        }}></div>
                                    ))}
                                </div>
                            ) : (
                                <span style={{ 
                                    position: 'relative', 
                                    zIndex: '1',
                                    wordBreak: 'break-word'
                                }}>{msg.text}</span>
                            )}
                            
                            {/* Shimmer effect for user messages */}
                            {msg.sender === 'user' && (
                                <div style={{
                                    position: 'absolute',
                                    top: '0',
                                    left: '-100%',
                                    right: '0',
                                    bottom: '0',
                                    background: 'linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent)',
                                    animation: 'shimmer 2.5s ease-in-out infinite',
                                    opacity: '0.7'
                                }}></div>
                            )}
                        </div>
                    </div>
                </div>
            ))}
            <div ref={messagesEndRef} />
        </div>

        {/* Input Area with Floating Effect */}
        <footer style={{
            padding: '20px 24px',
            background: 'rgba(15, 23, 42, 0.9)',
            borderTop: '1px solid rgba(148, 163, 184, 0.1)',
            backdropFilter: 'blur(24px)',
            boxShadow: '0 -10px 30px rgba(2, 6, 23, 0.5)'
        }}>
            <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '12px',
                background: 'rgba(248, 250, 252, 0.06)',
                border: '1px solid rgba(148, 163, 184, 0.15)',
                borderRadius: '14px',
                padding: '6px',
                transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',
                boxShadow: '0 4px 20px rgba(0, 0, 0, 0.15)',
                ':hover': {
                    borderColor: 'rgba(148, 163, 184, 0.25)'
                }
            }}>
                <input
                    ref={inputRef}
                    type="text"
                    value={inputText}
                    onChange={(e) => setInputText(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && !isLoading && handleSendMessage()}
                    placeholder="Ask the AI anything..."
                    disabled={isLoading}
                    style={{
                        flex: '1',
                        padding: '14px 18px',
                        background: 'transparent',
                        border: 'none',
                        outline: 'none',
                        color: '#F8FAFC',
                        fontSize: '15px',
                        fontFamily: 'Inter, sans-serif',
                        '::placeholder': {
                            color: '#94A3B8',
                            opacity: '0.7'
                        }
                    }}
                />
                <button
                    onClick={handleSendMessage}
                    disabled={isLoading || !inputText.trim()}
                    style={{
                        width: '44px',
                        height: '44px',
                        borderRadius: '10px',
                        border: 'none',
                        background: inputText.trim() && !isLoading 
                            ? 'linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)'
                            : 'rgba(148, 163, 184, 0.15)',
                        color: 'white',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        cursor: inputText.trim() && !isLoading ? 'pointer' : 'not-allowed',
                        transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',
                        transform: inputText.trim() && !isLoading ? 'scale(1)' : 'scale(0.95)',
                        opacity: inputText.trim() && !isLoading ? '1' : '0.6',
                        position: 'relative',
                        overflow: 'hidden'
                    }}
                    onMouseEnter={(e) => {
                        if (inputText.trim() && !isLoading) {
                            e.target.style.transform = 'scale(1.05)';
                            e.target.style.boxShadow = '0 6px 24px rgba(59, 130, 246, 0.4)';
                        }
                    }}
                    onMouseLeave={(e) => {
                        if (inputText.trim() && !isLoading) {
                            e.target.style.transform = 'scale(1)';
                            e.target.style.boxShadow = 'none';
                        }
                    }}
                    aria-label="Send message"
                >
                    {isLoading ? (
                        <div style={{
                            width: '18px',
                            height: '18px',
                            border: '2px solid rgba(255,255,255,0.2)',
                            borderTop: '2px solid white',
                            borderRadius: '50%',
                            animation: 'spin 1s linear infinite'
                        }}></div>
                    ) : (
                        <>
                            <IconSend style={{ fontSize: '18px', position: 'relative', zIndex: '1' }} />
                            {inputText.trim() && !isLoading && (
                                <div style={{
                                    position: 'absolute',
                                    top: '0',
                                    left: '0',
                                    right: '0',
                                    bottom: '0',
                                    background: 'linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%)',
                                    opacity: '0',
                                    transition: 'opacity 0.3s ease',
                                    ':hover': {
                                        opacity: '1'
                                    }
                                }}></div>
                            )}
                        </>
                    )}
                </button>
            </div>
        </footer>

        {/* CSS Animations */}
        <style jsx>{`
            @keyframes hologramPulse {
                0%, 100% { opacity: 0; transform: scale(1); }
                50% { opacity: 0.6; transform: scale(1.05); }
            }
            
            @keyframes messageSlideIn {
                from {
                    opacity: 0;
                    transform: translateY(16px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            @keyframes typingDot {
                0%, 60%, 100% {
                    transform: translateY(0);
                    opacity: 0.6;
                }
                30% {
                    transform: translateY(-4px);
                    opacity: 1;
                }
            }
            
            @keyframes shimmer {
                0% { left: -100%; }
                100% { left: 100%; }
            }
            
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }

            /* Custom scrollbar */
            ::-webkit-scrollbar {
                width: 6px;
            }
            ::-webkit-scrollbar-track {
                background: transparent;
            }
            ::-webkit-scrollbar-thumb {
                background: rgba(148, 163, 184, 0.3);
                border-radius: 3px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background: rgba(148, 163, 184, 0.5);
            }
        `}</style>
    </div>
);
  }








  
        // --- Komponen Halaman (Modernized) ---
        function DashboardContent({ allAssets }) {
            const chartStatusRef = useRef(null);
            const chartKeluarRef = useRef(null);
            const chartStatusInstance = useRef(null);
            const chartKeluarInstance = useRef(null);
            const { isDarkMode } = useContext(AppContext);

            const totalAssets = allAssets.length;
            const pendingVerification = allAssets.filter(asset => asset.status === 'Menunggu Persetujuan').length;
            const verifiedAssets = allAssets.filter(asset => asset.status === 'Disetujui' && !asset.tanggalKeluar).length; 
            const rejectedAssets = allAssets.filter(asset => asset.status === 'Ditolak').length;
            const barangKeluarData = allAssets.filter(asset => asset.status === 'Disetujui' && asset.tanggalKeluar && asset.penerima);

            useEffect(() => {
                const rootStyle = getComputedStyle(document.documentElement);
                const chartBgColor = rootStyle.getPropertyValue(isDarkMode ? '--bg-secondary-dark' : '--bg-secondary-light').trim();
                const legendColor = rootStyle.getPropertyValue(isDarkMode ? '--text-secondary-dark' : '--text-secondary-light').trim();
                const gridColor = rootStyle.getPropertyValue(isDarkMode ? '--border-soft-dark' : '--border-soft-light').trim();
                const tickColor = rootStyle.getPropertyValue(isDarkMode ? '--text-tertiary-dark' : '--text-tertiary-light').trim();
                
                const statusChartData = {
                    labels: ['Menunggu', 'Terverifikasi (Stok)', 'Ditolak', 'Sudah Keluar'],
                    datasets: [{
                        data: [pendingVerification, verifiedAssets, rejectedAssets, barangKeluarData.length],
                        backgroundColor: [rootStyle.getPropertyValue('--accent-warning').trim(), rootStyle.getPropertyValue('--accent-success').trim(), rootStyle.getPropertyValue('--accent-danger').trim(), rootStyle.getPropertyValue('--accent-secondary-light').trim()],
                        borderColor: chartBgColor, borderWidth: 3, hoverOffset: 8, borderRadius: 8,
                    }]
                };
                const statusChartOptions = {
                    responsive: true, maintainAspectRatio: false, cutout: '70%',
                    plugins: { legend: { position: 'bottom', labels: { color: legendColor, font: { family: 'Inter', size: 12, weight: '500' }, padding: 15, usePointStyle: true, pointStyle: 'rectRounded' } }, 
                    tooltip: {
                        backgroundColor: rootStyle.getPropertyValue(isDarkMode ? '--bg-tertiary-dark' : '--bg-tertiary-light').trim(),
                        titleColor: rootStyle.getPropertyValue(isDarkMode ? '--text-primary-dark' : '--text-primary-light').trim(),
                        bodyColor: rootStyle.getPropertyValue(isDarkMode ? '--text-secondary-dark' : '--text-secondary-light').trim(),
                        borderColor: rootStyle.getPropertyValue(isDarkMode ? '--border-soft-dark' : '--border-strong-light').trim(),
                        borderWidth: 1, padding: 10, cornerRadius: 6, usePointStyle: true,
                    }
                }
                };

                if (chartStatusRef.current) {
                    if (chartStatusInstance.current) { chartStatusInstance.current.destroy(); }
                    chartStatusInstance.current = new Chart(chartStatusRef.current.getContext('2d'), { type: 'doughnut', data: statusChartData, options: statusChartOptions });
                }

                const barangKeluarByKategori = barangKeluarData.reduce((acc, asset) => {
                    const kategori = asset.kategori || "Lainnya"; // Default category if undefined
                    acc[kategori] = (acc[kategori] || 0) + 1;
                    return acc;
                }, {});
                const kategoriLabels = Object.keys(barangKeluarByKategori);
                const kategoriData = Object.values(barangKeluarByKategori);

                const keluarChartData = {
                    labels: kategoriLabels,
                    datasets: [{
                        label: 'Jumlah Aset Keluar',
                        data: kategoriData,
                        backgroundColor: kategoriLabels.map((_, i) => `hsl(${ (i * 45 + parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--hue-primary'))) % 360 }, 70%, ${isDarkMode ? '60%' : '55%'})`),
                        borderColor: chartBgColor,
                        borderWidth: 1,
                        borderRadius: 4,
                        barThickness: 'flex',
                        maxBarThickness: 30,
                    }]
                };
                 const keluarChartOptions = {
                    responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                    scales: { x: { grid: { color: gridColor, borderColor: gridColor }, ticks: { color: tickColor, font: {family: 'Inter'} } }, y: { grid: { display: false, borderColor: gridColor }, ticks: { color: tickColor, font: {family: 'Inter'} } } },
                    plugins: { legend: { display: false }, /* Tooltip options similar */ }
                };


                if (chartKeluarRef.current && kategoriLabels.length > 0) {
                    if (chartKeluarInstance.current) { chartKeluarInstance.current.destroy(); }
                    chartKeluarInstance.current = new Chart(chartKeluarRef.current.getContext('2d'), { type: 'bar', data: keluarChartData, options: keluarChartOptions });
                } else if (chartKeluarRef.current && chartKeluarInstance.current) { // Clear chart if no data
                     chartKeluarInstance.current.destroy();
                     chartKeluarInstance.current = null;
                }


                return () => { 
                    if (chartStatusInstance.current) chartStatusInstance.current.destroy(); 
                    if (chartKeluarInstance.current) chartKeluarInstance.current.destroy();
                };
            }, [allAssets, isDarkMode, pendingVerification, verifiedAssets, rejectedAssets, barangKeluarData]); // Added dependencies

            const stats = [
                { title: 'Total Aset Terdaftar', value: totalAssets, icon: <IconAssetList />, color: 'blue' },
                { title: 'Menunggu Verifikasi', value: pendingVerification, icon: <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-6 h-6"><path strokeLinecap="round" strokeLinejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>, color: 'amber' },
                { title: 'Aset Siap Pakai', value: verifiedAssets, icon: <IconVerify />, color: 'emerald' },
                { title: 'Total Aset Keluar', value: barangKeluarData.length, icon: <IconBoxArrowOut />, color: 'secondary' } 
            ];
             const colorClasses = { 
                blue: { text: 'text-[var(--accent-primary-light)] dark:text-[var(--accent-primary-dark)]', iconBg: 'bg-[hsla(var(--hue-primary),70%,55%,0.1)] dark:bg-[hsla(var(--hue-primary),65%,60%,0.1)]', border: 'border-[var(--accent-primary-light)] dark:border-[var(--accent-primary-dark)]' },
                amber: { text: 'text-[var(--accent-warning)]', iconBg: 'bg-[hsla(40,80%,60%,0.1)]', border: 'border-[var(--accent-warning)]' },
                emerald: { text: 'text-[var(--accent-success)]', iconBg: 'bg-[hsla(140,60%,50%,0.1)]', border: 'border-[var(--accent-success)]' },
                red: { text: 'text-[var(--accent-danger)]', iconBg: 'bg-[hsla(0,70%,60%,0.1)]', border: 'border-[var(--accent-danger)]' },
                secondary: { text: 'text-[var(--accent-secondary-light)] dark:text-[var(--accent-secondary-dark)]', iconBg: 'bg-[hsla(var(--hue-secondary),65%,60%,0.1)] dark:bg-[hsla(var(--hue-secondary),60%,65%,0.1)]', border: 'border-[var(--accent-secondary-light)] dark:border-[var(--accent-secondary-dark)]' }
            };


return (
    // Latar belakang halaman yang lebih modern
    <div className="bg-gray-50 dark:bg-gray-900 min-h-screen"> 
        <div className="p-4 sm:p-6 md:p-8 space-y-8">
            {/* Judul dengan animasi masuk */}
            <h1 
                className="text-3xl sm:text-4xl font-bold text-gray-800 dark:text-white animate-on-load" 
                style={{ "--animation-delay": "0.1s" }} // Delay untuk animasi
            >
                Dashboard Overview
            </h1>
            
            {/* Grid Kartu Statistik */}
            <div className="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6">
                {stats.map((item, index) => (
                    <div 
                        key={item.title} 
                        // Kelas untuk Tampilan Modern + Animasi
                        className={`animate-on-load bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-5 rounded-2xl shadow-lg dark:shadow-black/20 border-l-4 ${colorClasses[item.color]?.border} flex items-center space-x-4 transition-all duration-300 hover:scale-105 hover:shadow-xl hover:-translate-y-1`}
                        // Delay animasi dibuat bertahap menggunakan JavaScript
                        style={{ "--animation-delay": `${0.2 + index * 0.1}s` }}
                    >
                        <div className={`p-4 ${colorClasses[item.color]?.iconBg} rounded-full text-2xl`}>
                            {/* Ikon Anda di sini, contoh: */}
                            <span>{item.icon}</span> 
                        </div>
                        <div>
                            <p className="text-gray-500 dark:text-gray-400 text-sm font-medium uppercase tracking-wider">{item.title}</p>
                            <p className={`text-3xl font-bold ${colorClasses[item.color]?.text}`}>{item.value}</p>
                        </div>
                    </div>
                ))}
            </div>

            {/* Grid untuk Chart */}
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div 
                    className="animate-on-load lg:col-span-1 bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 rounded-2xl shadow-lg"
                    style={{ "--animation-delay": "0.6s" }}
                >
                    <h3 className="text-xl font-semibold text-gray-800 dark:text-white mb-4">Distribusi Status Aset</h3>
                    <div className="w-full h-64 sm:h-72">{totalAssets > 0 ? <canvas ref={chartStatusRef}></canvas> : <p className="text-gray-500 dark:text-gray-400 text-center py-10">Tidak ada data aset.</p>}</div>
                </div>
                <div 
                    className="animate-on-load lg:col-span-2 bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 rounded-2xl shadow-lg"
                    style={{ "--animation-delay": "0.7s" }}
                >
                    <h3 className="text-xl font-semibold text-gray-800 dark:text-white mb-4">Aset Keluar per Kategori</h3>
                    <div className="w-full h-64 sm:h-72">{barangKeluarData.length > 0 ? <canvas ref={chartKeluarRef}></canvas> : <p className="text-gray-500 dark:text-gray-400 text-center py-10">Belum ada aset yang keluar.</p>}</div>
                </div>
            </div>

            {/* Grid untuk AI dan Aset Terkini */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div 
                    className="animate-on-load bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 rounded-2xl shadow-lg flex flex-col"
                    style={{ "--animation-delay": "0.8s" }}
                >
                    <h3 className="text-xl font-semibold text-gray-800 dark:text-white mb-3 flex items-center">
                        {/* Ganti dengan SVG atau komponen ikon Anda */}
                        <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V3m0 18v-3M5.636 5.636l-1.414-1.414m15.556 15.556l-1.414-1.414M4.222 19.778l1.414-1.414M18.364 5.636l1.414-1.414" /></svg>
                        <span className="ml-2">Analisis AI Cerdas</span>
                    </h3>
                    <p className="text-gray-600 dark:text-gray-300 mb-4 text-sm">Ajukan pertanyaan tentang data aset Anda.</p>
                    <textarea
                        className="w-full p-3 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-900/50 text-sm transition-all"
                        rows="3"
                        placeholder="Contoh: 'Total aset elektronik?'"
                    ></textarea>
                    <button className="mt-4 self-start bg-blue-600 text-white font-semibold text-sm py-2.5 px-6 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Tanyakan pada AI
                    </button>
                </div>
                <div 
                    className="animate-on-load bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm p-6 rounded-2xl shadow-lg flex flex-col"
                    style={{ "--animation-delay": "0.9s" }}
                >
                    <h3 className="text-xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                         {/* Ganti dengan SVG atau komponen ikon Anda */}
                        <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                        <span className="ml-2">Aset Keluar Terkini</span>
                    </h3>
                    <div className="space-y-3 flex-grow overflow-y-auto pr-2">
                        {barangKeluarData.length > 0 ? (
                            barangKeluarData.slice(0, 5).map(asset => ( 
                                <div key={asset.id} className="p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                                    <p className="text-sm font-medium text-gray-800 dark:text-gray-100">{asset.namaAset} <span className="text-xs text-gray-500">({asset.kodeAset})</span></p>
                                    <p className="text-xs text-gray-600 dark:text-gray-400">Keluar: {asset.tanggalKeluar} | Penerima: {asset.penerima}</p>
                                </div>
                            ))
                        ) : (
                            <p className="text-gray-500 dark:text-gray-400 text-center py-10">Tidak ada aset yang keluar.</p>
                        )}
                    </div>
                </div>
            </div>
        </div>
    </div>
);
  }



















































function PengajuanAsetContent({ navigateTo, setMessage }) { 
  const [kodeAset, setKodeAset] = useState('');
  const [namaAset, setNamaAset] = useState('');
  const [jumlah, setJumlah] = useState('');
  const [lokasi, setLokasi] = useState('');
  const [tanggal, setTanggal] = useState('');
  const [alasan, setAlasan] = useState('');
  const [imageFile, setImageFile] = useState(null);
  const [kategori, setKategori] = useState('');
  const [manualKategori, setManualKategori] = useState('');
  
  const kategoriAset = ["Elektronik", "Perabot", "Kendaraan", "ATK", "Lainnya"];

  // Function to generate asset code
  const generateKodeAset = (selectedKategori) => {
    const prefixMap = {
      "Elektronik": "ELK",
      "Perabot": "PRB",
      "Kendaraan": "KDR",
      "ATK": "ATK",
      "Lainnya": "LNY"
    };
    
    const prefix = selectedKategori === "Lainnya" 
      ? "LNY" 
      : prefixMap[selectedKategori] || "AST";
    
    const randomNum = Math.floor(1000 + Math.random() * 9000);
    return `AST-${prefix}-${randomNum}`;
  };

  // Update asset code when category changes
  useEffect(() => {
    if (kategori) {
      const selectedKategori = kategori === "Lainnya" ? manualKategori : kategori;
      if (selectedKategori) {
        setKodeAset(generateKodeAset(kategori));
      }
    }
  }, [kategori, manualKategori]);

  const resetForm = () => { 
    setKodeAset(''); 
    setNamaAset(''); 
    setJumlah(''); 
    setLokasi(''); 
    setTanggal(''); 
    setAlasan(''); 
    setImageFile(null); 
    setKategori('');
    setManualKategori('');
  };

  const handleSimpan = () => {
    const selectedKategori = kategori === "Lainnya" ? manualKategori : kategori;
    
    if (!kodeAset || !namaAset || !jumlah || !lokasi || !tanggal || !alasan || !selectedKategori) { 
      setMessage('Harap lengkapi semua bidang formulir, termasuk kategori.'); 
      return; 
    }
    
    const newAsset = { 
      id: Date.now(), 
      kodeAset, 
      namaAset, 
      jumlah, 
      lokasi, 
      tanggal, 
      alasan, 
      kategori: selectedKategori, 
      imageName: imageFile ? imageFile.name : 'Tidak ada gambar', 
      status: 'Menunggu Persetujuan' 
    };
    
    const currentAssets = getAssets(); 
    saveAssets([...currentAssets, newAsset]);
    setMessage('Pengajuan aset berhasil disimpan dan menunggu verifikasi!'); 
    resetForm();
  };

  const handleBatal = () => { 
    resetForm(); 
    setMessage('Pengajuan aset dibatalkan.'); 
  };
  
  const handleImageDrop = (e) => { 
    e.preventDefault(); 
    const file = e.dataTransfer.files[0]; 
    if (file && file.type.startsWith('image/')) { 
      setImageFile(file); 
    } else { 
      setMessage("Hanya file gambar yang diperbolehkan.")
    } 
  };
  
  const handleImageBrowse = (e) => { 
    const file = e.target.files[0]; 
    if (file && file.type.startsWith('image/')) { 
      setImageFile(file); 
    } else { 
      setMessage("Hanya file gambar yang diperbolehkan.") 
    }
  };

  // Function to download asset code as text file and QR code
  const downloadAssetCode = () => {
    if (!kodeAset) {
      setMessage('Kode aset belum tersedia. Pilih kategori terlebih dahulu.');
      return;
    }

    const selectedKategori = kategori === "Lainnya" ? manualKategori : kategori;
    const currentDate = new Date().toLocaleDateString('id-ID');
    
    // Download text file
    const content = `KODE ASET
==================
Kode Aset: ${kodeAset}
Nama Aset: ${namaAset }
Kategori: ${selectedKategori }
Tanggal Generate: ${currentDate}

Catatan: 
- Kode ini dibuat secara otomatis
- Gunakan kode ini untuk identifikasi aset
- Simpan file ini sebagai referensi`;

    const blob = new Blob([content], { type: 'text/plain' });
    const url = window.URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `Kode-Aset-${kodeAset}.txt`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    window.URL.revokeObjectURL(url);

    // Generate and download QR code
    generateQRCode();
    
    setMessage('Kode aset dan QR code berhasil didownload!');
  };

  // Function to generate QR code using QRCode.js
  const generateQRCode = () => {
    // Load QRCode.js library if not already loaded
    if (typeof QRCode === 'undefined') {
      const script = document.createElement('script');
      script.src = 'https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js';
      script.onload = () => {
        createQRCode();
      };
      document.head.appendChild(script);
    } else {
      createQRCode();
    }
  };

  // Create QR code and download
  const createQRCode = () => {
    try {
      // Create QR code
      const qr = qrcode(0, 'M');
      qr.addData(kodeAset);
      qr.make();
      
      // Create canvas
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      const moduleCount = qr.getModuleCount();
      const cellSize = 8;
      const margin = 4;
      const size = moduleCount * cellSize + margin * 2;
      
      canvas.width = size;
      canvas.height = size + 60; // Extra space for text
      
      // White background
      ctx.fillStyle = 'white';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Draw QR code
      ctx.fillStyle = 'black';
      for (let row = 0; row < moduleCount; row++) {
        for (let col = 0; col < moduleCount; col++) {
          if (qr.isDark(row, col)) {
            ctx.fillRect(
              col * cellSize + margin,
              row * cellSize + margin,
              cellSize,
              cellSize
            );
          }
        }
      }
      
      // Add text below QR code
      ctx.fillStyle = 'black';
      ctx.font = 'bold 14px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(kodeAset, canvas.width / 2, size + 20);
      
      ctx.font = '12px Arial';
      ctx.fillText('Asset Code', canvas.width / 2, size + 40);
      ctx.fillText(new Date().toLocaleDateString('id-ID'), canvas.width / 2, size + 55);
      
      // Download QR code
      canvas.toBlob((blob) => {
        const url = window.URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `QR-Code-${kodeAset}.png`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        window.URL.revokeObjectURL(url);
      }, 'image/png');
      
    } catch (error) {
      console.error('Error generating QR code:', error);
      // Fallback: create a simple placeholder image
      createFallbackQR();
    }
  };

  // Fallback QR code generator
  const createFallbackQR = () => {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const size = 200;
    
    canvas.width = size;
    canvas.height = size + 60;
    
    // White background
    ctx.fillStyle = 'white';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Draw border
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 2;
    ctx.strokeRect(10, 10, size - 20, size - 20);
    
    // Draw placeholder pattern
    ctx.fillStyle = 'black';
    const gridSize = 8;
    const codeHash = kodeAset.split('').reduce((hash, char) => {
      return ((hash << 5) - hash + char.charCodeAt(0)) & 0xffffffff;
    }, 0);
    
    for (let i = 0; i < 20; i++) {
      for (let j = 0; j < 20; j++) {
        if ((codeHash + i * 20 + j) % 3 === 0) {
          ctx.fillRect(15 + i * gridSize, 15 + j * gridSize, gridSize - 1, gridSize - 1);
        }
      }
    }
    
    // Add text
    ctx.fillStyle = 'black';
    ctx.font = 'bold 14px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(kodeAset, canvas.width / 2, size + 20);
    ctx.font = '12px Arial';
    ctx.fillText('Asset Code (Placeholder)', canvas.width / 2, size + 40);
    ctx.fillText(new Date().toLocaleDateString('id-ID'), canvas.width / 2, size + 55);
    
    // Download
    canvas.toBlob((blob) => {
      const url = window.URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `QR-Code-${kodeAset}.png`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      window.URL.revokeObjectURL(url);
    }, 'image/png');
  };

  const fieldInput = [
    {id:'namaAset', label:'Nama Aset', value:namaAset, setter:setNamaAset, placeholder:'Contoh: Laptop Dell XPS 15'},
    {id:'jumlah', label:'Jumlah Unit', value:jumlah, setter:setJumlah, placeholder:'Contoh: 5', type:'number'},
    {
      id:'kategori', 
      label:'Kategori Aset', 
      value:kategori, 
      setter:(val) => {
        setKategori(val);
        if (val !== "Lainnya") setManualKategori('');
      }, 
      type:'select', 
      options: kategoriAset
    },
    {id:'lokasi', label:'Lokasi Penempatan', value:lokasi, setter:setLokasi, placeholder:'Contoh: Ruang Meeting'},
    {id:'tanggal', label:'Tanggal Perolehan/Kebutuhan', value:tanggal, setter:setTanggal, type:'date'},
    {id:'alasan', label:'Alasan Pengajuan & Spesifikasi', value:alasan, setter:setAlasan, placeholder:'Deskripsikan kebutuhan dan spesifikasi aset...', type:'textarea'}
  ];

return (
  <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 font-sans antialiased">
    <div className="container mx-auto px-4 py-8 sm:py-12 lg:py-16">
      
      {/* Header Section */}
      <div className="max-w-5xl mx-auto">
        <div className="text-center mb-12">
          <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full mb-6 shadow-2xl shadow-blue-500/30">
            <svg className="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
            </svg>
          </div>
          <h1 className="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-4">
            Pengajuan Aset Baru
          </h1>
          <p className="text-xl text-slate-600 max-w-3xl mx-auto leading-relaxed">
            Lengkapi formulir dengan alur terstruktur untuk memastikan semua data akurat dan sistem terintegrasi
          </p>
        </div>

        {/* Progress Indicator */}
        <div className="mb-8 max-w-3xl mx-auto">
          <div className="flex items-center justify-between">
            {[
              { step: 1, title: 'Detail Aset', icon: 'ðŸ“‹' },
              { step: 2, title: 'Kategori & Docs', icon: 'ðŸ“' },
              { step: 3, title: 'Kode & Konfirmasi', icon: 'âœ…' }
            ].map((item, index) => (
              <div key={item.step} className="flex items-center">
                <div className="flex flex-col items-center">
                  <div className="w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg shadow-blue-500/30 mb-2">
                    {item.icon}
                  </div>
                  <span className="text-sm font-semibold text-slate-600">{item.title}</span>
                </div>
                {index < 2 && (
                  <div className="flex-1 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 mx-4 rounded-full shadow-inner"></div>
                )}
              </div>
            ))}
          </div>
        </div>

        {/* Main Form Card */}
        <div className="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl shadow-blue-500/10 border border-white/20 overflow-hidden">
          <form onSubmit={handleSimpan} className="divide-y divide-slate-200/50">

            {/* Section 1: Asset Details */}
            <div className="p-8 sm:p-12 space-y-8">
              <div className="flex items-center gap-6">
                <div className="flex-shrink-0 flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-500 text-white font-bold text-xl shadow-lg shadow-blue-500/30">
                  1
                </div>
                <div>
                  <h2 className="text-2xl font-bold text-slate-800 mb-2">Detail Informasi Aset</h2>
                  <p className="text-slate-600">Masukkan informasi dasar mengenai aset yang akan didaftarkan</p>
                </div>
              </div>
              
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                {fieldInput.filter(f => f.type !== 'textarea' && f.type !== 'select').map(field => (
                  <div key={field.id} className="space-y-2">
                    <label htmlFor={field.id} className="block text-sm font-bold text-slate-700">
                      {field.label}
                    </label>
                    <div className="relative">
                      <input
                        id={field.id}
                        type={field.type || 'text'}
                        className="block w-full rounded-2xl border-2 border-slate-200 bg-slate-50/50 px-6 py-4 text-slate-900 shadow-inner transition-all duration-300 focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 focus:outline-none placeholder-slate-400 font-medium"
                        placeholder={field.placeholder}
                        value={field.value}
                        onChange={(e) => field.setter(e.target.value)}
                      />
                    </div>
                  </div>
                ))}
                
                <div className="lg:col-span-2">
                  {fieldInput.filter(f => f.type === 'textarea').map(field => (
                    <div key={field.id} className="space-y-2">
                      <label htmlFor={field.id} className="block text-sm font-bold text-slate-700">
                        {field.label}
                      </label>
                      <textarea
                        id={field.id}
                        rows="5"
                        className="block w-full rounded-2xl border-2 border-slate-200 bg-slate-50/50 px-6 py-4 text-slate-900 shadow-inner transition-all duration-300 focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 focus:outline-none placeholder-slate-400 font-medium resize-none"
                        placeholder={field.placeholder}
                        value={field.value}
                        onChange={(e) => field.setter(e.target.value)}
                      />
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* Section 2: Category & Documentation */}
            <div className="p-8 sm:p-12 space-y-8">
              <div className="flex items-center gap-6">
                {/* DIUBAH: Gradien ungu/pink dihilangkan */}
                <div className="flex-shrink-0 flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-500 text-white font-bold text-xl shadow-lg shadow-blue-500/30">
                  2
                </div>
                <div>
                  <h2 className="text-2xl font-bold text-slate-800 mb-2">Kategori & Dokumentasi</h2>
                  <p className="text-slate-600">Pilih kategori dan upload dokumentasi pendukung</p>
                </div>
              </div>
              
              <div className="grid grid-cols-1 gap-6">
                {fieldInput.filter(f => f.type === 'select').map(field => (
                  <div key={field.id} className="space-y-2">
                    <label htmlFor={field.id} className="block text-sm font-bold text-slate-700">
                      {field.label}
                    </label>
                    <div className="relative">
                      {/* DIUBAH: Gradien dan focus ring ungu dihilangkan */}
                      <select
                        id={field.id}
                        className="block w-full rounded-2xl border-2 border-slate-200 bg-slate-50/50 px-6 py-4 text-slate-900 shadow-inner transition-all duration-300 focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 focus:outline-none font-medium appearance-none"
                        value={field.value}
                        onChange={(e) => field.setter(e.target.value)}
                        required
                      >
                        <option value="">Pilih Kategori...</option>
                        {field.options.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                      </select>
                      <div className="absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none">
                        <svg className="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                        </svg>
                      </div>
                    </div>
                  </div>
                ))}
                
                {kategori === "Lainnya" && (
                  <div className="space-y-2">
                    <label htmlFor="manualKategori" className="block text-sm font-bold text-slate-700">
                      Ketik Kategori Baru
                    </label>
                    {/* DIUBAH: Gradien dan focus ring ungu dihilangkan */}
                    <input
                      type="text"
                      id="manualKategori"
                      className="block w-full rounded-2xl border-2 border-slate-200 bg-slate-50/50 px-6 py-4 text-slate-900 shadow-inner transition-all duration-300 focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 focus:outline-none placeholder-slate-400 font-medium"
                      placeholder="Contoh: Peralatan Fotografi"
                      value={manualKategori}
                      onChange={(e) => setManualKategori(e.target.value)}
                      required
                    />
                  </div>
                )}
                
                <div className="space-y-2">
                  <label className="block text-sm font-bold text-slate-700">Gambar Aset</label>
                  {imageFile ? (
                    <div className="relative group">
                      <div className="flex items-center justify-between rounded-2xl bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 p-6 shadow-lg">
                        <div className="flex items-center gap-4">
                          <div className="flex-shrink-0 w-12 h-12 rounded-2xl bg-gradient-to-r from-green-500 to-emerald-500 text-white flex items-center justify-center shadow-lg">
                            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                            </svg>
                          </div>
                          <div>
                            <p className="font-bold text-slate-800">{imageFile.name}</p>
                            <p className="text-sm text-slate-600">File berhasil diunggah</p>
                          </div>
                        </div>
                        <button 
                          type="button" 
                          onClick={() => setImageFile(null)} 
                          className="px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-red-500/40"
                        >
                          Hapus
                        </button>
                      </div>
                    </div>
                  ) : (
                    // DIUBAH: Seluruh warna ungu/pink diganti dengan biru/slate
                    <label htmlFor="imageUpload" className="group flex flex-col items-center justify-center w-full rounded-2xl border-2 border-dashed border-slate-300 p-12 text-center cursor-pointer transition-all duration-300 hover:border-blue-500 hover:bg-blue-50/50 hover:scale-[1.02]">
                      <div className="p-6 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg shadow-blue-500/30">
                        <IconUpload className="w-8 h-8 text-white" />
                      </div>
                      <p className="text-lg font-semibold text-slate-700 mb-2">
                        <span className="text-blue-600">Klik untuk upload</span> atau seret dan lepas file
                      </p>
                      <p className="text-sm text-slate-500">PNG, JPG, GIF (Maksimal 2MB)</p>
                      <input id="imageUpload" type="file" className="hidden" onChange={handleImageBrowse} />
                    </label>
                  )}
                </div>
              </div>
            </div>

            {/* Section 3: Code & Confirmation */}
            <div className="p-8 sm:p-12 space-y-8">
              <div className="flex items-center gap-6">
                {/* DIUBAH: Gradien hijau/teal dihilangkan */}
                <div className="flex-shrink-0 flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-500 text-white font-bold text-xl shadow-lg shadow-blue-500/30">
                  3
                </div>
                <div>
                  <h2 className="text-2xl font-bold text-slate-800 mb-2">Kode Aset & Konfirmasi</h2>
                  <p className="text-slate-600">Sistem akan generate kode unik untuk aset Anda</p>
                </div>
              </div>
              
              <div className="space-y-6">
                <div className="space-y-2">
                  <label className="block text-sm font-bold text-slate-700">Kode Aset & QR (Dihasilkan Otomatis)</label>
                  <div className="relative">
                    <div className="flex items-center gap-4 rounded-2xl bg-slate-100 border-2 border-slate-200 p-6 shadow-inner">
                      <div className="flex-grow text-center">
                        <div className="inline-flex items-center gap-3 px-6 py-3 bg-white rounded-2xl shadow-md">
                          <svg className="w-6 h-6 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z" />
                          </svg>
                          <span className="font-mono text-xl font-bold text-slate-700">
                            {kodeAset || 'Akan muncul setelah data lengkap'}
                          </span>
                        </div>
                      </div>
                      <button
                        type="button"
                        onClick={downloadAssetCode}
                        disabled={!kodeAset}
                        className="group flex-shrink-0 inline-flex items-center gap-3 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 px-6 py-3 font-semibold text-white shadow-lg shadow-blue-500/30 transition-all duration-300 hover:scale-105 disabled:from-slate-400 disabled:to-slate-500 disabled:cursor-not-allowed disabled:shadow-none disabled:scale-100"
                      >
                        <IconDownload className="w-5 h-5 group-hover:animate-bounce" />
                        <span>Download QR</span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            {/* Action Buttons */}
            <div className="p-8 bg-slate-50/80 flex items-center justify-end gap-4">
              <button
                type="button"
                onClick={handleBatal}
                className="px-8 py-3 rounded-2xl bg-slate-200 text-slate-700 font-semibold transition-all duration-300 hover:bg-slate-300/80 hover:scale-105"
              >
                Batal
              </button>
              <button
                type="submit"
                className="group inline-flex items-center gap-3 px-10 py-4 rounded-2xl bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold shadow-2xl shadow-blue-500/30 transition-all duration-300 hover:scale-105 hover:shadow-blue-500/40"
              >
                <span>Simpan & Kirim Pengajuan</span>
                <svg className="w-5 h-5 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <style jsx>{`
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
      }
      
      input:focus, textarea:focus, select:focus {
        transform: translateY(-2px);
      }
      
      .group:hover .group-hover\\:animate-bounce {
        animation: bounce 1s infinite;
      }
      
      @keyframes bounce {
        0%, 20%, 53%, 80%, 100% {
          animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
          transform: translate3d(0,0,0);
        }
        40%, 43% {
          animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);
          transform: translate3d(0, -8px, 0);
        }
        70% {
          animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);
          transform: translate3d(0, -4px, 0);
        }
        90% {
          transform: translate3d(0,-1px,0);
        }
      }
    `}</style>
  </div>
);
}




























  
     function BarangKeluarContent({ navigateTo, setMessage }) {
            const [allAssets, setAllAssets] = useState(getAssets());
            const [searchTerm, setSearchTerm] = useState('');
            const [editingAsset, setEditingAsset] = useState(null); 
            const [tanggalKeluarInput, setTanggalKeluarInput] = useState('');
            const [penerimaInput, setPenerimaInput] = useState('');

            const barangSudahKeluar = allAssets.filter(a => a.tanggalKeluar && a.penerima);
            const barangBelumKeluarDisetujui = allAssets.filter(a => a.status === 'Disetujui' && !a.tanggalKeluar);

            const filteredBarangSudahKeluar = barangSudahKeluar.filter(asset =>
                asset.namaAset.toLowerCase().includes(searchTerm.toLowerCase()) ||
                asset.kodeAset.toLowerCase().includes(searchTerm.toLowerCase()) ||
                (asset.penerima && asset.penerima.toLowerCase().includes(searchTerm.toLowerCase()))
            );
            const filteredBarangBelumKeluar = barangBelumKeluarDisetujui.filter(asset =>
                asset.namaAset.toLowerCase().includes(searchTerm.toLowerCase()) ||
                asset.kodeAset.toLowerCase().includes(searchTerm.toLowerCase())
            );


            const handleOpenEditModal = (asset) => {
                setEditingAsset(asset);
                setTanggalKeluarInput(asset.tanggalKeluar || new Date().toISOString().slice(0,10));
                setPenerimaInput(asset.penerima || '');
            };

            const handleSaveBarangKeluar = () => {
                if (!editingAsset || !tanggalKeluarInput || !penerimaInput) {
                    setMessage("Tanggal keluar dan penerima harus diisi.");
                    return;
                }
                const updatedAssets = allAssets.map(asset =>
                    asset.id === editingAsset.id
                        ? { ...asset, tanggalKeluar: tanggalKeluarInput, penerima: penerimaInput, status: 'Disetujui' } 
                        : asset
                );
                saveAssets(updatedAssets);
                setAllAssets(updatedAssets); 
                setMessage(`Aset "${editingAsset.namaAset}" telah ditandai sebagai keluar.`);
                setEditingAsset(null);
            };
            
            const handleBatalkanKeluar = (assetId) => {
                 // Menggunakan Modal kustom sebagai pengganti window.confirm
                 // Untuk implementasi penuh, Anda perlu state untuk menampilkan modal konfirmasi ini.
                 // Di sini, saya akan langsung proses seolah-olah dikonfirmasi.
                const confirmBatal = true; // Ganti dengan logika modal konfirmasi
                if (confirmBatal) {
                    const updatedAssets = allAssets.map(asset =>
                        asset.id === assetId
                            ? { ...asset, tanggalKeluar: null, penerima: null } 
                            : asset
                    );
                    saveAssets(updatedAssets);
                    setAllAssets(updatedAssets);
                    setMessage("Status keluar aset berhasil dibatalkan.");
                }
            };


     return (
  <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 sm:p-6 lg:p-8">
    <div className="max-w-7xl mx-auto space-y-8">
      {/* Header Section */}
      <div className="relative bg-white/80 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5 rounded-3xl"></div>
        <div className="relative flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
          <div className="space-y-2">
            <h1 className="text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
              Manajemen Barang Keluar
            </h1>
            <p className="text-slate-600 text-lg">Catat dan lihat aset yang telah dikeluarkan atau dialokasikan</p>
          </div>
          <button
            onClick={() => navigateTo('dashboard')}
            className="group inline-flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-slate-100 to-slate-200 hover:from-slate-200 hover:to-slate-300 text-slate-700 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 border border-slate-200/50"
          >
            <IconArrowLeft className="w-5 h-5 group-hover:-translate-x-1 transition-transform duration-300" />
            Kembali
          </button>
        </div>
      </div>

      {/* Asset Selection Card */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="flex items-center gap-4 mb-6">
          <div className="p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg">
            <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
            </svg>
          </div>
          <div>
            <h3 className="text-2xl font-bold text-slate-800">Tandai Aset Keluar</h3>
            <p className="text-slate-600">Pilih aset yang sudah disetujui untuk dicatat sebagai barang keluar</p>
          </div>
        </div>

        {/* Search Bar */}
        <div className="relative mb-6">
          <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <div className="p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl">
              <IconSearch className="w-4 h-4 text-white" />
            </div>
          </div>
          <input
            type="text"
            placeholder="Cari aset berdasarkan nama atau kode..."
            className="w-full pl-16 pr-6 py-4 bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 outline-none text-slate-700 placeholder-slate-400 font-medium transition-all duration-300 shadow-inner"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
          />
        </div>

        {/* Asset List */}
        {filteredBarangBelumKeluar.length === 0 ? (
          <div className="text-center py-16">
            <div className="inline-flex p-6 bg-gradient-to-r from-slate-100 to-blue-100 rounded-3xl mb-4">
              <svg className="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
              </svg>
            </div>
            <p className="text-slate-500 text-lg font-medium">Tidak ada aset siap dikeluarkan</p>
            <p className="text-slate-400">atau tidak cocok dengan pencarian Anda</p>
          </div>
        ) : (
          <div className="max-h-96 overflow-y-auto space-y-4 pr-2 custom-scrollbar">
            {filteredBarangBelumKeluar.map(asset => (
              <div
                key={asset.id}
                className="group relative bg-gradient-to-r from-white to-blue-50/30 border border-slate-200/50 rounded-2xl p-5 hover:shadow-xl hover:shadow-blue-500/10 transition-all duration-300 hover:scale-[1.02]"
              >
                <div className="absolute inset-0 bg-gradient-to-r from-blue-500/0 to-indigo-500/0 group-hover:from-blue-500/5 group-hover:to-indigo-500/5 rounded-2xl transition-all duration-300"></div>
                <div className="relative flex justify-between items-center">
                  <div className="space-y-2">
                    <div className="flex items-center gap-3">
                      {/* DIUBAH: Indikator status hijau diganti dengan biru agar konsisten */}
                      <div className="w-3 h-3 bg-blue-500 rounded-full ring-2 ring-blue-200"></div>
                      <p className="font-bold text-slate-800 text-lg">
                        {asset.namaAset}
                      </p>
                      <span className="px-3 py-1 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 text-sm font-medium rounded-full border border-slate-200">
                        {asset.kodeAset}
                      </span>
                    </div>
                    <p className="text-slate-500 flex items-center gap-2">
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                      </svg>
                      Lokasi Awal: {asset.lokasi}
                    </p>
                  </div>
                  <button
                    onClick={() => handleOpenEditModal(asset)}
                    className="group/btn px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-blue-500/30 hover:scale-105"
                  >
                    <span className="flex items-center gap-2">
                      Tandai Keluar
                      <svg className="w-4 h-4 group-hover/btn:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                      </svg>
                    </span>
                  </button>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>

      {/* History Section */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="flex items-center gap-4 mb-6">
          {/* DIUBAH: Ikon ungu/pink diganti dengan biru/indigo */}
          <div className="p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg">
            <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <h3 className="text-2xl font-bold text-slate-800">Riwayat Barang Keluar</h3>
            <p className="text-slate-600">Daftar lengkap aset yang telah dikeluarkan</p>
          </div>
        </div>

        {filteredBarangSudahKeluar.length === 0 ? (
          <div className="text-center py-16">
            {/* DIUBAH: Background gradien ungu dihilangkan */}
            <div className="inline-flex p-6 bg-gradient-to-r from-slate-100 to-blue-100 rounded-3xl mb-4">
              <svg className="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
            <p className="text-slate-500 text-lg font-medium">Belum ada riwayat barang keluar</p>
            <p className="text-slate-400">Mulai tandai aset keluar untuk melihat riwayat</p>
          </div>
        ) : (
          <div className="overflow-hidden rounded-2xl border border-slate-200">
            <div className="overflow-x-auto">
              <table className="min-w-full bg-white">
                <thead className="bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200">
                  <tr>
                    {['Nama Aset', 'Kode', 'Tgl Keluar', 'Penerima', 'Kategori', 'Aksi'].map((header, index) => (
                      <th key={index} className="px-6 py-4 text-left font-bold text-slate-700 text-sm uppercase tracking-wider">
                        {header}
                      </th>
                    ))}
                  </tr>
                </thead>
                <tbody className="divide-y divide-slate-100">
                  {filteredBarangSudahKeluar.map((asset, index) => (
                    <tr key={asset.id} className="group hover:bg-gradient-to-r hover:from-blue-50/30 hover:to-indigo-50/30 transition-all duration-300">
                      <td className="px-6 py-4">
                        <div className="flex items-center gap-3">
                          {/* DIUBAH: Indikator status merah/pink diganti abu-abu untuk status "non-aktif/sudah keluar" */}
                          <div className="w-2 h-2 bg-slate-400 rounded-full"></div>
                          <span className="font-semibold text-slate-800">{asset.namaAset}</span>
                        </div>
                      </td>
                      <td className="px-6 py-4">
                        <span className="px-3 py-1 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 text-sm font-medium rounded-full">
                          {asset.kodeAset}
                        </span>
                      </td>
                      <td className="px-6 py-4 text-slate-600 font-medium">{asset.tanggalKeluar}</td>
                      <td className="px-6 py-4 text-slate-600 font-medium">{asset.penerima}</td>
                      <td className="px-6 py-4">
                        {/* DIUBAH: Tag Kategori diseragamkan dengan tag Kode Aset */}
                        <span className="px-3 py-1 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 text-sm font-medium rounded-full">
                          {asset.kategori || 'N/A'}
                        </span>
                      </td>
                      <td className="px-6 py-4">
                        <div className="flex items-center gap-3">
                          <button
                            onClick={() => handleOpenEditModal(asset)}
                            className="px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white text-sm font-semibold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-blue-500/30"
                          >
                            Edit
                          </button>
                          <button
                            onClick={() => handleBatalkanKeluar(asset.id)}
                            // DIUBAH: Warna pink dihilangkan dari tombol "Batal"
                            className="px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white text-sm font-semibold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-red-500/30"
                          >
                            Batal
                          </button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        )}
      </div>

      {/* Modal */}
      {editingAsset && (
        <Modal
          onClose={() => setEditingAsset(null)}
          title={`Catat Keluar: ${editingAsset.namaAset}`}
          size="max-w-2xl"
        >
          <div className="bg-gradient-to-br from-white to-blue-50/30 rounded-3xl p-8 border border-blue-100">
            <div className="space-y-6">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div className="space-y-2">
                  <label htmlFor="tanggalKeluar" className="block text-sm font-bold text-slate-700">
                    Tanggal Keluar
                  </label>
                  <div className="relative">
                    <input
                      type="date"
                      id="tanggalKeluar"
                      className="w-full px-4 py-3 bg-white border-2 border-slate-200 rounded-2xl focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 outline-none transition-all duration-300 text-slate-700 font-medium shadow-inner"
                      value={tanggalKeluarInput}
                      onChange={(e) => setTanggalKeluarInput(e.target.value)}
                    />
                  </div>
                </div>
                <div className="space-y-2">
                  <label htmlFor="penerima" className="block text-sm font-bold text-slate-700">
                    Penerima / Departemen
                  </label>
                  <div className="relative">
                    <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                      <svg className="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                      </svg>
                    </div>
                    <input
                      type="text"
                      id="penerima"
                      className="w-full pl-12 pr-4 py-3 bg-white border-2 border-slate-200 rounded-2xl focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 outline-none transition-all duration-300 text-slate-700 font-medium shadow-inner"
                      placeholder="Masukkan nama penerima atau departemen"
                      value={penerimaInput}
                      onChange={(e) => setPenerimaInput(e.target.value)}
                    />
                  </div>
                </div>
              </div>
            </div>
            <div className="flex justify-end gap-4 mt-8">
              <button
                onClick={() => setEditingAsset(null)}
                className="px-6 py-3 bg-gradient-to-r from-slate-200 to-slate-300 hover:from-slate-300 hover:to-slate-400 text-slate-700 font-semibold rounded-2xl transition-all duration-300 hover:scale-105 shadow-lg"
              >
                Batal
              </button>
              <button
                onClick={handleSaveBarangKeluar}
                className="px-8 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white font-semibold rounded-2xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-blue-500/30"
              >
                <span className="flex items-center gap-2">
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                  </svg>
                  Simpan
                </span>
              </button>
            </div>
          </div>
        </Modal>
      )}
    </div>

    <style jsx>{`
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: linear-gradient(to bottom, #f1f5f9, #e2e8f0);
        border-radius: 10px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: linear-gradient(to bottom, #3b82f6, #6366f1);
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(to bottom, #2563eb, #4f46e5);
      }
    `}</style>
  </div>
);
     }




















// Enhanced QR scanning functionality (pure JavaScript)
class QRScanner {
  constructor(options = {}) {
    this.videoElement = options.videoElement;
    this.canvasElement = options.canvasElement;
    this.onResult = options.onResult || (() => {});
    this.onError = options.onError || (() => {});
    this.scanInterval = options.scanInterval || 500;
    this.scanActive = false;
    this.stream = null;
    this.intervalId = null;

    // Validasi awal
    if (!this.videoElement) {
      console.error("QRScanner Error: videoElement tidak disediakan atau null.");
      this.onError("videoElement is null or undefined.");
    }

    if (!this.canvasElement) {
      console.error("QRScanner Error: canvasElement tidak disediakan atau null.");
      this.onError("canvasElement is null or undefined.");
    }

    // Load jsQR jika belum tersedia
    if (!window.jsQR) {
      this.loadJsQR();
    }
  }

  loadJsQR() {
    return new Promise((resolve, reject) => {
      if (window.jsQR) return resolve();

      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js';
      script.onload = resolve;
      script.onerror = reject;
      document.head.appendChild(script);
    });
  }

  async startCamera() {
    try {
      if (!this.videoElement) throw new Error("videoElement tidak tersedia.");

      this.stream = await navigator.mediaDevices.getUserMedia({
        video: {
          facingMode: 'environment',
          width: { ideal: 1280 },
          height: { ideal: 720 }
        }
      });

      this.videoElement.srcObject = this.stream;
      await this.videoElement.play();

      this.scanActive = true;
      this.startScanning();

      return true;
    } catch (err) {
      this.onError('Camera access denied: ' + err.message);
      return false;
    }
  }

  startScanning() {
    if (!this.canvasElement || !this.videoElement) {
      this.onError("Tidak bisa mulai scanning: canvasElement atau videoElement null.");
      return;
    }

    this.intervalId = setInterval(() => {
      if (!this.scanActive) return;

      if (this.videoElement.readyState === this.videoElement.HAVE_ENOUGH_DATA) {
        this.canvasElement.width = this.videoElement.videoWidth;
        this.canvasElement.height = this.videoElement.videoHeight;

        const ctx = this.canvasElement.getContext('2d');
        ctx.drawImage(this.videoElement, 0, 0, this.canvasElement.width, this.canvasElement.height);

        const imageData = ctx.getImageData(0, 0, this.canvasElement.width, this.canvasElement.height);
        const code = window.jsQR(imageData.data, imageData.width, imageData.height);

        if (code) {
          this.onResult(code.data);
          this.stop();
        }
      }
    }, this.scanInterval);
  }

  stop() {
    this.scanActive = false;
    clearInterval(this.intervalId);

    if (this.stream) {
      this.stream.getTracks().forEach(track => track.stop());
      this.stream = null;
    }

    if (this.videoElement) {
      this.videoElement.srcObject = null;
    }
  }

  static async scanImageFile(file) {
    if (!window.jsQR) {
      await new QRScanner().loadJsQR();
    }

    return new Promise((resolve, reject) => {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      const img = new Image();
      const reader = new FileReader();

      reader.onload = (e) => {
        img.onload = () => {
          canvas.width = img.width;
          canvas.height = img.height;
          ctx.drawImage(img, 0, 0);

          try {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const code = window.jsQR(imageData.data, imageData.width, imageData.height);

            if (code) {
              resolve(code.data);
            } else {
              reject(new Error('No QR code found in image'));
            }
          } catch (err) {
            reject(err);
          }
        };
        img.onerror = () => reject(new Error('Failed to load image'));
        img.src = e.target.result;
      };
      reader.onerror = () => reject(new Error('Failed to read file'));
      reader.readAsDataURL(file);
    });
  }
}

// Enhanced React component with improved QR scanning

function PelacakanAsetContent({ navigateTo }) {
  const [allAssets, setAllAssets] = useState([]);
  const [filteredAssets, setFilteredAssets] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedLocation, setSelectedLocation] = useState('Semua Lokasi');
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [qrScanResult, setQrScanResult] = useState(null);
  const [isLoading, setIsLoading] = useState(false);

  // Efek untuk memuat data aset saat komponen pertama kali dirender.
  useEffect(() => {
    const loadedAssets = getAssets();
    setAllAssets(loadedAssets);
    setFilteredAssets(loadedAssets);
  }, []);

  // Efek untuk memfilter aset setiap kali ada perubahan pada pencarian atau filter lokasi.
  useEffect(() => {
    let currentFiltered = allAssets;

    if (searchTerm) {
      const lowerCaseSearchTerm = searchTerm.toLowerCase();
      currentFiltered = currentFiltered.filter(asset =>
        asset.kodeAset.toLowerCase().includes(lowerCaseSearchTerm) ||
        asset.namaAset.toLowerCase().includes(lowerCaseSearchTerm) ||
        asset.lokasi.toLowerCase().includes(lowerCaseSearchTerm));
    }

    if (selectedLocation !== 'Semua Lokasi') {
      currentFiltered = currentFiltered.filter(asset => asset.lokasi === selectedLocation);
    }

    setFilteredAssets(currentFiltered);
  }, [searchTerm, selectedLocation, allAssets]);

  // Menangani hasil pemindaian QR, baik dari file.
  const handleQRResult = (qrData) => {
    const foundAsset = allAssets.find(asset => asset.kodeAset === qrData);
    if (foundAsset) {
      setQrScanResult(foundAsset);
      setSearchTerm(foundAsset.kodeAset); // Otomatis mengisi pencarian
    } else {
      setQrScanResult({
        message: 'Aset tidak ditemukan untuk kode: ' + qrData
      });
    }
    setIsLoading(false);
  };

  // Menangani unggahan file gambar QR code.
  const handleFileUpload = async (event) => {
    const file = event.target.files[0];
    if (!file) return;

    setIsModalOpen(true);
    setIsLoading(true);
    setQrScanResult(null);

    try {
      const qrData = await QRScanner.scanImageFile(file);
      handleQRResult(qrData);
    } catch (error) {
      setQrScanResult({
        message: error.message || 'Gagal memproses QR code dari gambar.'
      });
      setIsLoading(false);
    }
    // Reset input file agar bisa memilih file yang sama lagi
    event.target.value = null;
  };

  // Menutup modal dan mereset state.
  const closeModal = () => {
    setIsModalOpen(false);
    setQrScanResult(null);
    setIsLoading(false);
  };

  const uniqueLocations = ['Semua Lokasi', ...new Set(allAssets.map(asset => asset.lokasi))];

return (
  <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 sm:p-6 lg:p-8">
    <div className="max-w-7xl mx-auto space-y-8">
      {/* Header Section */}
      <div className="relative bg-white/80 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5 rounded-3xl"></div>
        <div className="relative flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
          <div className="space-y-2">
            <h1 className="text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
              Pelacakan Aset
            </h1>
            <p className="text-slate-600 text-lg">Lihat status dan lokasi aset Anda secara real-time menggunakan pencarian atau pemindaian QR</p>
          </div>
          <button
            onClick={() => navigateTo('dashboard')}
            className="group inline-flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-slate-100 to-slate-200 hover:from-slate-200 hover:to-slate-300 text-slate-700 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 border border-slate-200/50"
          >
            <IconArrowLeft className="w-5 h-5 group-hover:-translate-x-1 transition-transform duration-300" />
            Kembali
          </button>
        </div>
      </div>

      {/* Search and Filter Section */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="flex items-center gap-4 mb-6">
        </div>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          {/* Search Input */}
          <div className="relative md:col-span-2">
            <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
              <div className="p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl">
                <IconSearch className="w-4 h-4 text-white" />
              </div>
            </div>
            <input
              type="text"
              placeholder="Cari lokasi, nama aset, atau kode..."
              className="w-full pl-16 pr-6 py-4 bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 outline-none text-slate-700 placeholder-slate-400 font-medium transition-all duration-300 shadow-inner"
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
            />
          </div>

          {/* Location Filter */}
          <div className="relative">
            <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
              <svg className="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </div>
            <select
              value={selectedLocation}
              onChange={(e) => setSelectedLocation(e.target.value)}
              className="w-full pl-12 pr-6 py-4 bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 outline-none text-slate-700 font-medium transition-all duration-300 shadow-inner appearance-none"
            >
              {uniqueLocations.map((location) => (
                <option key={location} value={location}>
                  {location}
                </option>
              ))}
            </select>
          </div>
        </div>

        {/* Action Buttons */}
        <div className="flex flex-wrap justify-end gap-4 mb-6">
          <label className="group cursor-pointer inline-flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-blue-500/30 hover:scale-105">
            <IconUpload className="w-5 h-5 group-hover:-translate-y-1 transition-transform duration-300" />
            Unggah QR Code
            <input type="file" accept="image/*" className="hidden" onChange={handleFileUpload} />
          </label>
          <button
            onClick={() => window.location.href = 'pindai.html'}
            className="group inline-flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-slate-100 to-slate-200 hover:from-slate-200 hover:to-slate-300 text-slate-700 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 border border-slate-200/50"
          >
            <IconQrCode className="w-5 h-5 group-hover:scale-110 transition-transform duration-300" />
            Pindai (Halaman Baru)
          </button>
        </div>

        {/* Asset Table */}
        {filteredAssets.length === 0 ? (
          <div className="text-center py-16">
            <div className="inline-flex p-6 bg-gradient-to-r from-slate-100 to-blue-100 rounded-3xl mb-4">
              <svg className="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
            </div>
            <p className="text-slate-500 text-lg font-medium">Tidak ada aset yang cocok</p>
            <p className="text-slate-400">dengan kriteria pencarian Anda</p>
          </div>
        ) : (
          <div className="overflow-hidden rounded-2xl border border-slate-200">
            <div className="overflow-x-auto">
              <table className="min-w-full bg-white">
                <thead className="bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200">
                  <tr>
                    {['Kode Aset', 'Nama Aset', 'Lokasi', 'Tgl. Perolehan', 'Status'].map((header, index) => (
                      <th key={index} className="px-6 py-4 text-left font-bold text-slate-700 text-sm uppercase tracking-wider">
                        {header}
                      </th>
                    ))}
                  </tr>
                </thead>
                <tbody className="divide-y divide-slate-100">
                  {filteredAssets.map((asset, index) => (
                    <tr key={asset.id} className="group hover:bg-gradient-to-r hover:from-blue-50/30 hover:to-indigo-50/30 transition-all duration-300">
                      <td className="px-6 py-4">
                        <span className="px-3 py-1 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 text-sm font-medium rounded-full">
                          {asset.kodeAset}
                        </span>
                      </td>
                      <td className="px-6 py-4">
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 bg-gradient-to-r from-blue-400 to-indigo-500 rounded-full"></div>
                          <span className="font-semibold text-slate-800">{asset.namaAset}</span>
                        </div>
                      </td>
                      <td className="px-6 py-4">
                        <span className="flex items-center gap-2 text-slate-600 font-medium">
                          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                          </svg>
                          {asset.lokasi}
                        </span>
                      </td>
                      <td className="px-6 py-4 text-slate-600 font-medium">{asset.tanggal}</td>
                      <td className="px-6 py-4">
                        <span className={`px-3 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${
                          asset.status === 'Menunggu Persetujuan' 
                            ? 'bg-gradient-to-r from-amber-100 to-yellow-100 text-amber-700' :
                          asset.status === 'Disetujui' 
                            ? 'bg-gradient-to-r from-emerald-100 to-green-100 text-emerald-700' :
                            'bg-gradient-to-r from-red-100 to-pink-100 text-red-700'
                        }`}>
                          {asset.status}
                        </span>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        )}
      </div>

      {/* Modal untuk hasil pemindaian QR */}
      {isModalOpen && (
        <Modal
          onClose={closeModal}
          title={qrScanResult?.id ? "Hasil Pemindaian QR" : "Memproses QR Code"}
          size="max-w-2xl"
        >
          <div className="bg-gradient-to-br from-white to-blue-50/30 rounded-3xl p-8 border border-blue-100">
            {isLoading ? (
              <div className="text-center py-12">
                <div className="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent mb-6 shadow-lg"></div>
                <p className="text-slate-600 text-lg font-medium">Mencari data dari QR code...</p>
                <p className="text-slate-400 text-sm mt-2">Mohon tunggu sebentar</p>
              </div>
            ) : qrScanResult?.id ? (
              <div className="space-y-6">
                <div className="text-center">
                  <div className="inline-flex p-4 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl mb-4 shadow-lg">
                    <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                    </svg>
                  </div>
                  <h3 className="text-2xl font-bold text-slate-800 mb-2">Aset Ditemukan!</h3>
                  <p className="text-slate-600">Data aset berhasil ditemukan dari QR code</p>
                </div>
                
                <div className="bg-white/60 backdrop-blur-sm rounded-2xl p-6 space-y-4 border border-white/40">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                      <p className="text-sm font-bold text-slate-700 mb-1">Kode Aset</p>
                      <p className="text-slate-800 font-semibold">{qrScanResult.kodeAset}</p>
                    </div>
                    <div>
                      <p className="text-sm font-bold text-slate-700 mb-1">Nama Aset</p>
                      <p className="text-slate-800 font-semibold">{qrScanResult.namaAset}</p>
                    </div>
                    <div>
                      <p className="text-sm font-bold text-slate-700 mb-1">Lokasi</p>
                      <p className="text-slate-800 font-semibold flex items-center gap-2">
                        <svg className="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        {qrScanResult.lokasi}
                      </p>
                    </div>
                    <div>
                      <p className="text-sm font-bold text-slate-700 mb-1">Status</p>
                      <span className={`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${
                        qrScanResult.status === 'Menunggu Persetujuan' 
                          ? 'bg-gradient-to-r from-amber-100 to-yellow-100 text-amber-700' :
                        qrScanResult.status === 'Disetujui' 
                          ? 'bg-gradient-to-r from-emerald-100 to-green-100 text-emerald-700' :
                          'bg-gradient-to-r from-red-100 to-pink-100 text-red-700'
                      }`}>
                        {qrScanResult.status}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            ) : (
              <div className="text-center py-12">
                <div className="inline-flex p-4 bg-gradient-to-r from-red-500 to-pink-500 rounded-2xl mb-4 shadow-lg">
                  <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </div>
                <h3 className="text-xl font-bold text-slate-800 mb-2">QR Code Tidak Valid</h3>
                <p className="text-red-600 text-lg">{qrScanResult?.message || "Terjadi kesalahan saat memproses QR code"}</p>
              </div>
            )}

            <div className="flex justify-end mt-8">
              <button 
                onClick={closeModal} 
                className="px-8 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white font-semibold rounded-2xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-blue-500/30"
              >
                <span className="flex items-center gap-2">
                  <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                  Tutup
                </span>
              </button>
            </div>
          </div>
        </Modal>
      )}
    </div>

    <style jsx>{`
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: linear-gradient(to bottom, #f1f5f9, #e2e8f0);
        border-radius: 10px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: linear-gradient(to bottom, #3b82f6, #6366f1);
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(to bottom, #2563eb, #4f46e5);
      }
    `}</style>
  </div>
);
}





























        
       function DaftarAsetContent({ navigateTo }) {
  const [allAssets, setAllAssets] = useState([]);
  const [filteredAssets, setFilteredAssets] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [expandedRowId, setExpandedRowId] = useState(null);
  
  useEffect(() => {
    const loadedAssets = getAssets();
    setAllAssets(loadedAssets);
    setFilteredAssets(loadedAssets);
  }, []);

  useEffect(() => {
    if (searchTerm) {
      const lowerCaseSearchTerm = searchTerm.toLowerCase();
      const currentFiltered = allAssets.filter(asset => 
        asset.kodeAset.toLowerCase().includes(lowerCaseSearchTerm) ||
        asset.namaAset.toLowerCase().includes(lowerCaseSearchTerm) ||
        asset.lokasi.toLowerCase().includes(lowerCaseSearchTerm) ||
        asset.alasan.toLowerCase().includes(lowerCaseSearchTerm) ||
        asset.status.toLowerCase().includes(lowerCaseSearchTerm)
      );
      setFilteredAssets(currentFiltered);
    } else {
      setFilteredAssets(allAssets);
    }
  }, [searchTerm, allAssets]);

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 sm:p-6 lg:p-8">
      <div className="max-w-7xl mx-auto space-y-8">
        {/* Header Section */}
        <div className="relative bg-white/80 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
          <div className="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5 rounded-3xl"></div>
          <div className="relative flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
            <div className="space-y-2">
              <h1 className="text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                Daftar Semua Aset
              </h1>
              <p className="text-slate-600 text-lg">Daftar lengkap semua aset yang terdaftar dalam sistem.</p>
            </div>
            <button 
              onClick={() => navigateTo('dashboard')}
              className="group flex items-center gap-2 px-5 py-3 bg-white hover:bg-slate-50 border border-slate-200 text-slate-700 rounded-xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-slate-500/10"
            >
              <IconArrowLeft className="w-5 h-5"/>
              <span>Kembali ke Dashboard</span>
            </button>
          </div>
        </div>

        {/* Main Content Section */}
        <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl shadow-xl shadow-blue-500/10 overflow-hidden">
          {/* Search Section */}
          <div className="p-6 border-b border-slate-200/60">
            <div className="relative w-full">
              <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                <IconSearch className="w-5 h-5 text-slate-400" />
              </div>
              <input
                type="text"
                placeholder="Cari berdasarkan kode, nama, lokasi, alasan, atau status..."
                className="w-full pl-12 pr-4 py-3 bg-slate-50 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 outline-none text-slate-700 font-medium transition"
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
              />
            </div>
          </div>

          {/* Content Area */}
          <div className="px-6 pb-6">
            {filteredAssets.length === 0 ? (
              <div className="text-center py-16 border-2 border-dashed border-slate-200 rounded-2xl">
                <div className="inline-flex p-6 bg-slate-100 rounded-3xl mb-4">
                  <IconSearch className="w-12 h-12 text-slate-400" />
                </div>
                <p className="text-slate-500 text-lg font-medium">Aset Tidak Ditemukan</p>
                <p className="text-slate-400">Coba kata kunci lain atau periksa kembali filter Anda.</p>
              </div>
            ) : (
              <div className="overflow-hidden rounded-2xl border border-slate-200/80 shadow-md">
                <div className="overflow-x-auto">
                  <table className="min-w-full bg-white">
                    <thead className="bg-slate-50 border-b border-slate-200">
                      <tr>
                        <th className="px-6 py-4 text-left font-bold text-slate-600 text-sm uppercase tracking-wider">Kode</th>
                        <th className="px-6 py-4 text-left font-bold text-slate-600 text-sm uppercase tracking-wider">Nama Aset</th>
                        <th className="px-6 py-4 text-left font-bold text-slate-600 text-sm uppercase tracking-wider">Lokasi</th>
                        <th className="px-6 py-4 text-left font-bold text-slate-600 text-sm uppercase tracking-wider">Tanggal</th>
                        <th className="px-6 py-4 text-left font-bold text-slate-600 text-sm uppercase tracking-wider">Status</th>
                        <th className="px-6 py-4 text-right font-bold text-slate-600 text-sm uppercase tracking-wider">Aksi</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-100">
                      {filteredAssets.map(asset => (
                        <React.Fragment key={asset.id}>
                          <tr className="hover:bg-blue-50/50 transition-colors duration-200">
                            <td className="px-6 py-4">
                              <span className="px-3 py-1 bg-slate-100 text-slate-600 text-sm font-medium rounded-full">
                                {asset.kodeAset}
                              </span>
                            </td>
                            <td className="px-6 py-4 font-semibold text-slate-800">{asset.namaAset}</td>
                            <td className="px-6 py-4 text-slate-500">{asset.lokasi}</td>
                            <td className="px-6 py-4 text-slate-500">{asset.tanggal}</td>
                            <td className="px-6 py-4">
                              <span className={`px-3 py-1.5 inline-flex text-xs leading-tight font-bold rounded-full ${
                                asset.status === 'Menunggu Persetujuan' ? 'bg-amber-100 text-amber-700' :
                                asset.status === 'Disetujui' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
                              }`}>
                                {asset.status}
                              </span>
                            </td>
                            <td className="px-6 py-4 text-right">
                              <button
                                onClick={() => setExpandedRowId(expandedRowId === asset.id ? null : asset.id)}
                                className="p-2 rounded-xl hover:bg-slate-100 text-slate-500 hover:text-slate-700 transition-colors"
                              >
                                <IconChevronDown className={`w-5 h-5 transition-transform duration-300 ${expandedRowId === asset.id ? 'rotate-180' : ''}`} />
                              </button>
                            </td>
                          </tr>
                          {expandedRowId === asset.id && (
                            <tr className="bg-slate-50">
                              <td colSpan="6" className="px-6 py-4">
                                <div className="p-4 bg-slate-100 rounded-xl border border-slate-200">
                                  <h4 className="font-bold text-slate-700 mb-2">Alasan Pengajuan:</h4>
                                  <p className="text-slate-600 whitespace-pre-wrap">{asset.alasan}</p>
                                </div>
                              </td>
                            </tr>
                          )}
                        </React.Fragment>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
}
        
        function VerifikasiAsetContent({ navigateTo, setMessage }) { 
            const [pendingAssets, setPendingAssets] = useState([]); const [selectedAssetDetail, setSelectedAssetDetail] = useState(null); const [historyAssets, setHistoryAssets] = useState([]); const [searchTerm, setSearchTerm] = useState('');
            useEffect(() => { const allAssets = getAssets(); const pending = allAssets.filter(asset => asset.status === 'Menunggu Persetujuan'); setPendingAssets(pending); setHistoryAssets(allAssets.filter(asset => asset.status !== 'Menunggu Persetujuan')); }, []);
            const updateAssetStatus = (id, newStatus) => { const allAssets = getAssets(); const updatedAssets = allAssets.map(asset => asset.id === id ? { ...asset, status: newStatus } : asset ); saveAssets(updatedAssets); setPendingAssets(updatedAssets.filter(asset => asset.status === 'Menunggu Persetujuan')); setHistoryAssets(updatedAssets.filter(asset => asset.status !== 'Menunggu Persetujuan')); setMessage(`Aset "${updatedAssets.find(a => a.id === id).namaAset}" berhasil ${newStatus === 'Disetujui' ? 'disetujui' : 'ditolak'}.`); setSelectedAssetDetail(null); };
            const handleSetujui = (id) => { updateAssetStatus(id, 'Disetujui'); }; const handleTolak = (id) => { updateAssetStatus(id, 'Ditolak'); }; const handleLihatDetail = (asset) => { setSelectedAssetDetail(asset); };
            const handleDeleteAsset = (idToDelete) => { 
                // Menggunakan Modal kustom sebagai pengganti window.confirm
                // Untuk implementasi penuh, Anda perlu state untuk menampilkan modal konfirmasi ini.
                // Di sini, saya akan langsung proses seolah-olah dikonfirmasi.
                const confirmDelete = true; // Ganti dengan logika modal konfirmasi
                if (confirmDelete) { 
                    const allAssets = getAssets(); 
                    const updatedAssets = allAssets.filter(asset => asset.id !== idToDelete); 
                    saveAssets(updatedAssets); 
                    setPendingAssets(updatedAssets.filter(asset => asset.status === 'Menunggu Persetujuan')); 
                    setHistoryAssets(updatedAssets.filter(asset => asset.status !== 'Menunggu Persetujuan')); 
                    setMessage('Aset berhasil dihapus secara permanen.'); 
                }
            };
            const filteredPendingAssets = pendingAssets.filter(asset => asset.kodeAset.toLowerCase().includes(searchTerm.toLowerCase()) || asset.namaAset.toLowerCase().includes(searchTerm.toLowerCase()) || asset.lokasi.toLowerCase().includes(searchTerm.toLowerCase()) || asset.alasan.toLowerCase().includes(searchTerm.toLowerCase()));
            const filteredHistoryAssets = historyAssets.filter(asset => asset.kodeAset.toLowerCase().includes(searchTerm.toLowerCase()) || asset.namaAset.toLowerCase().includes(searchTerm.toLowerCase()) || asset.lokasi.toLowerCase().includes(searchTerm.toLowerCase()) || asset.alasan.toLowerCase().includes(searchTerm.toLowerCase()) || asset.status.toLowerCase().includes(searchTerm.toLowerCase()));
          return (
  <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 sm:p-6 lg:p-8">
    <div className="max-w-7xl mx-auto space-y-8">
      {/* Header Section */}
      <div className="relative bg-white/80 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5 rounded-3xl"></div>
        <div className="relative flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
          <div className="space-y-2">
            <h1 className="text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
              Verifikasi Pengajuan Aset
            </h1>
            <p className="text-slate-600 text-lg">Verifikasi atau tolak pengajuan aset yang masuk dari pengguna</p>
          </div>
          <button
            onClick={() => navigateTo('dashboard')}
            className="group inline-flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-slate-100 to-slate-200 hover:from-slate-200 hover:to-slate-300 text-slate-700 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 border border-slate-200/50"
          >
            <IconArrowLeft className="w-5 h-5 group-hover:-translate-x-1 transition-transform duration-300" />
            Kembali
          </button>
        </div>
      </div>

      {/* Search Section */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="flex items-center gap-4 mb-6">
      
        
        </div>
        <div className="relative">
          <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <div className="p-2 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-xl">
              <IconSearch className="w-4 h-4 text-white" />
            </div>
          </div>
          <input
            type="text"
            placeholder="Cari aset yang menunggu atau dalam riwayat..."
            className="w-full pl-16 pr-6 py-4 bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 outline-none text-slate-700 placeholder-slate-400 font-medium transition-all duration-300 shadow-inner"
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
          />
        </div>
      </div>

      {/* Pending Approval Section */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="flex items-center justify-between mb-6">
          <div className="flex items-center gap-4">
            <div className="p-3 bg-gradient-to-r from-amber-400 to-amber-500 rounded-2xl shadow-lg">
              <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            </div>
            <div>
              <h3 className="text-2xl font-bold text-slate-800">Menunggu Persetujuan</h3>
              <p className="text-slate-600">Aset yang memerlukan verifikasi</p>
            </div>
          </div>
          <span className="px-4 py-2 bg-gradient-to-r from-amber-400 to-amber-500 text-white text-sm font-bold rounded-full shadow-lg">
            {filteredPendingAssets.length} Aset
          </span>
        </div>

        {filteredPendingAssets.length === 0 ? (
          <div className="text-center py-16">
            <div className="inline-flex p-6 bg-gradient-to-r from-slate-100 to-amber-100 rounded-3xl mb-4">
              <svg className="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
            </div>
            <p className="text-slate-500 text-lg font-medium">Tidak ada aset yang menunggu verifikasi</p>
            <p className="text-slate-400">Semua pengajuan telah diproses atau cocok dengan pencarian Anda</p>
          </div>
        ) : (
          <div className="space-y-4">
            {filteredPendingAssets.map(asset => (
              <div key={asset.id} className="group relative bg-gradient-to-r from-white to-amber-50/30 border border-slate-200/50 rounded-2xl p-6 hover:shadow-xl hover:shadow-amber-500/10 transition-all duration-300 hover:scale-[1.02]">
                <div className="absolute inset-0 bg-gradient-to-r from-amber-500/0 to-amber-500/0 group-hover:from-amber-500/5 group-hover:to-amber-500/5 rounded-2xl transition-all duration-300"></div>
                <div className="relative flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
                  <div className="flex-1 space-y-3">
                    <div className="flex items-center gap-3">
                      <div className="w-3 h-3 bg-amber-400 rounded-full shadow-lg shadow-amber-500/30 animate-pulse"></div>
                      <p className="font-bold text-slate-800 text-lg">{asset.jumlah} unit {asset.namaAset}</p>
                      <span className="px-3 py-1 bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 text-sm font-medium rounded-full border border-slate-200">{asset.kodeAset}</span>
                    </div>
                    <p className="text-slate-600 flex items-center gap-2">
                       <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                       {asset.lokasi}
                     </p>
                     <div className="text-sm text-slate-500 space-y-1">
                       <p className="flex items-center gap-2">
                         <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3a1 1 0 011-1h6a1 1 0 011 1v4h3a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2h3z" /></svg>
                         Diajukan: {asset.tanggal}
                       </p>
                       <p className="flex items-start gap-2">
                         <svg className="w-4 h-4 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                         Alasan: {asset.alasan.substring(0,70)}{asset.alasan.length > 70 ? '...' : ''}
                       </p>
                     </div>
                  </div>
                  <div className="flex flex-col sm:flex-row items-stretch sm:items-center gap-3 w-full lg:w-auto">
                    <button onClick={() => handleSetujui(asset.id)} className="group/btn px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-green-500/30 hover:scale-105">
                      <span className="flex items-center justify-center gap-2">
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" /></svg>
                        Setujui
                      </span>
                    </button>
                    <button onClick={() => handleTolak(asset.id)} className="group/btn px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-red-500/30 hover:scale-105">
                      <span className="flex items-center justify-center gap-2">
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
                        Tolak
                      </span>
                    </button>
                    <button onClick={() => handleLihatDetail(asset)} className="group/btn px-6 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 border border-slate-200/50">
                       <span className="flex items-center justify-center gap-2">
                         <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
                         Detail
                       </span>
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>

      {/* History Section */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="flex items-center gap-4 mb-6">
          <div className="p-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl shadow-lg">
            <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
          </div>
          <div>
            <h3 className="text-2xl font-bold text-slate-800">Riwayat Verifikasi</h3>
            <p className="text-slate-600">Daftar lengkap aset yang telah diverifikasi</p>
          </div>
        </div>

        {filteredHistoryAssets.length === 0 ? (
          <div className="text-center py-16">
            <div className="inline-flex p-6 bg-gradient-to-r from-slate-100 to-blue-100 rounded-3xl mb-4">
              <svg className="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
            </div>
            <p className="text-slate-500 text-lg font-medium">Belum ada riwayat verifikasi</p>
          </div>
        ) : (
          <div className="overflow-hidden rounded-2xl border border-slate-200">
            <div className="overflow-x-auto">
              <table className="min-w-full bg-white">
                <thead className="bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200">
                  <tr>
                    {['Kode', 'Nama Aset', 'Status', 'Tanggal Update', 'Aksi'].map((header) => (
                      <th key={header} className="px-6 py-4 text-left font-bold text-slate-700 text-sm uppercase tracking-wider">{header}</th>
                    ))}
                  </tr>
                </thead>
                <tbody className="divide-y divide-slate-100">
                  {filteredHistoryAssets.map((asset) => (
                    <tr key={asset.id} className="group hover:bg-gradient-to-r hover:from-blue-50/30 hover:to-indigo-50/30">
                      <td className="px-6 py-4"><span className="px-3 py-1 bg-slate-100 text-slate-600 text-sm font-medium rounded-full">{asset.kodeAset}</span></td>
                      <td className="px-6 py-4">
                        <div className="flex items-center gap-3">
                          <div className={`w-2 h-2 rounded-full ${asset.status === 'Disetujui' ? 'bg-green-500' : 'bg-red-500'}`}></div>
                          <span className="font-semibold text-slate-800">{asset.namaAset}</span>
                        </div>
                      </td>
                      <td className="px-6 py-4">
                        <span className={`px-3 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${asset.status === 'Disetujui' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                          {asset.status}
                        </span>
                      </td>
                      <td className="px-6 py-4 text-slate-600 font-medium">{asset.tanggal}</td>
                      <td className="px-6 py-4">
                        <div className="flex items-center gap-3">
                          <button onClick={() => handleLihatDetail(asset)} className="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm font-semibold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-blue-500/30">Detail</button>
                          <button onClick={() => handleDeleteAsset(asset.id)} className="px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-semibold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-red-500/30">Hapus</button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        )}
      </div>

      {/* Modal for Asset Detail */}
      {selectedAssetDetail && (
        <Modal
          onClose={() => setSelectedAssetDetail(null)}
          title="Detail Aset Diajukan"
          size="max-w-2xl"
        >
          <div className="bg-gradient-to-br from-white to-blue-50/30 rounded-3xl p-8 border border-blue-100">
            <div className="space-y-6">
              <div className="text-center">
                <div className="inline-flex p-4 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl mb-4 shadow-lg">
                  <svg className="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                </div>
                <h3 className="text-2xl font-bold text-slate-800 mb-2">Informasi Detail Aset</h3>
              </div>
              <div className="bg-white/60 backdrop-blur-sm rounded-2xl p-6 space-y-4 border border-white/40">
                 <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                   <div>
                     <p className="text-sm font-bold text-slate-700 mb-1">Kode Aset</p>
                     <p className="text-slate-800 font-semibold">{selectedAssetDetail.kodeAset}</p>
                   </div>
                   <div>
                     <p className="text-sm font-bold text-slate-700 mb-1">Nama Aset</p>
                     <p className="text-slate-800 font-semibold">{selectedAssetDetail.namaAset}</p>
                   </div>
                   <div>
                     <p className="text-sm font-bold text-slate-700 mb-1">Jumlah</p>
                     <p className="text-slate-800 font-semibold">{selectedAssetDetail.jumlah} unit</p>
                   </div>
                   <div>
                     <p className="text-sm font-bold text-slate-700 mb-1">Lokasi</p>
                     <p className="text-slate-800 font-semibold flex items-center gap-2">
                       <svg className="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                       {selectedAssetDetail.lokasi}
                     </p>
                   </div>
                   <div>
                     <p className="text-sm font-bold text-slate-700 mb-1">Tanggal Pengajuan</p>
                     <p className="text-slate-800 font-semibold">{selectedAssetDetail.tanggal}</p>
                   </div>
                   <div>
                     <p className="text-sm font-bold text-slate-700 mb-1">Status</p>
                     <span className={`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${
                        selectedAssetDetail.status === 'Menunggu Persetujuan' ? 'bg-amber-100 text-amber-700' :
                        selectedAssetDetail.status === 'Disetujui' ? 'bg-green-100 text-green-700' :
                        'bg-red-100 text-red-700'
                      }`}>
                       {selectedAssetDetail.status}
                     </span>
                   </div>
                 </div>
                 <div className="col-span-2 pt-4 border-t border-slate-200">
                   <p className="text-sm font-bold text-slate-700 mb-2">Alasan Pengajuan</p>
                   <p className="text-slate-800 bg-slate-50 rounded-xl p-4 border border-slate-200">{selectedAssetDetail.alasan}</p>
                 </div>
                 {selectedAssetDetail.imageName !== 'Tidak ada gambar' && (
                   <div className="col-span-2 pt-4 border-t border-slate-200">
                     <p className="text-sm font-bold text-slate-700 mb-2">Nama Gambar</p>
                     <p className="text-slate-800 font-semibold bg-slate-50 rounded-xl p-4 border border-slate-200 flex items-center gap-2">
                       <svg className="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                       {selectedAssetDetail.imageName}
                     </p>
                   </div>
                 )}
              </div>
            </div>
          </div>
        </Modal>
      )}
    </div>
  </div>
  );
};

        
        function LaporanContent({ navigateTo, setMessage }) { 
            const [allAssets, setAllAssets] = useState([]); const [activeTab, setActiveTab] = useState('Belum Diverifikasi'); const [searchTerm, setSearchTerm] = useState(''); const [selectedDate, setSelectedDate] = useState(''); const [selectedAssetDetail, setSelectedAssetDetail] = useState(null);
            useEffect(() => { const loadedAssets = getAssets(); setAllAssets(loadedAssets); }, []);
            const getFilteredAssetsByTab = (tab) => { let filtered = []; if (tab === 'Belum Diverifikasi') { filtered = allAssets.filter(asset => asset.status === 'Menunggu Persetujuan'); } else if (tab === 'Terverifikasi') { filtered = allAssets.filter(asset => asset.status === 'Disetujui'); } else if (tab === 'Ditolak') { filtered = allAssets.filter(asset => asset.status === 'Ditolak'); } if (searchTerm) { const lowerCaseSearchTerm = searchTerm.toLowerCase(); filtered = filtered.filter(asset => asset.kodeAset.toLowerCase().includes(lowerCaseSearchTerm) || asset.namaAset.toLowerCase().includes(lowerCaseSearchTerm) || asset.lokasi.toLowerCase().includes(lowerCaseSearchTerm) || asset.alasan.toLowerCase().includes(lowerCaseSearchTerm) ); } if (selectedDate) { filtered = filtered.filter(asset => asset.tanggal === selectedDate); } return filtered; };
            const assetsToDisplay = getFilteredAssetsByTab(activeTab);
            const downloadReport = () => { if (assetsToDisplay.length === 0) { setMessage("Tidak ada data untuk diunduh dalam kategori ini."); return; } const headers = ["KODE ASET", "NAMA ASET", "LOKASI", "TANGGAL PEROLEHAN", "ALASAN", "STATUS VERIFIKASI"]; const csvRows = []; csvRows.push(headers.join(',')); for (const asset of assetsToDisplay) { const row = [ `"${asset.kodeAset}"`, `"${asset.namaAset}"`, `"${asset.lokasi}"`, `"${asset.tanggal}"`, `"${asset.alasan.replace(/"/g, '""')}"`, `"${asset.status === 'Menunggu Persetujuan' ? 'Belum Diverifikasi' : asset.status}"` ]; csvRows.push(row.join(',')); } const csvString = csvRows.join('\n'); const blob = new Blob([`\uFEFF${csvString}`], { type: 'text/csv;charset=utf-8;' }); const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = `laporan_aset_${activeTab.toLowerCase().replace(/\s/g, '_')}_${new Date().toISOString().slice(0,10)}.csv`; document.body.appendChild(link); link.click(); document.body.removeChild(link); setMessage("Laporan berhasil diunduh!"); };
            const handleLihatDetail = (asset) => { setSelectedAssetDetail(asset); };




            
          return (
  <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 sm:p-6 lg:p-8">
    <div className="max-w-7xl mx-auto space-y-8">
      {/* Header Section */}
      <div className="relative bg-white/80 backdrop-blur-sm border border-white/20 rounded-3xl p-6 sm:p-8 shadow-xl shadow-blue-500/10">
        <div className="absolute inset-0 bg-gradient-to-r from-blue-600/5 to-indigo-600/5 rounded-3xl"></div>
        <div className="relative space-y-2">
          <h1 className="text-3xl sm:text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
            Laporan Aset Terperinci
          </h1>
          <p className="text-slate-600 text-lg">Lihat dan unduh laporan aset berdasarkan status verifikasi dan filter lainnya.</p>
        </div>
      </div>

      {/* Main Content Section */}
      <div className="bg-white/90 backdrop-blur-sm border border-white/20 rounded-3xl shadow-xl shadow-blue-500/10 overflow-hidden">
        {/* DIUBAH: Layout Tab dibuat lebih ringkas dan modern */}
        <div className="border-b border-slate-200/60">
          <div className="px-6 flex items-center gap-2 overflow-x-auto">
            {['Belum Diverifikasi', 'Terverifikasi', 'Ditolak'].map(tabName => {
              // Menentukan warna dot berdasarkan nama tab
              const dotColor = tabName === 'Belum Diverifikasi' ? 'bg-amber-500' :
                               tabName === 'Terverifikasi' ? 'bg-green-500' : 'bg-red-500';

              return (
                <button
                  key={tabName}
                  className={`group relative flex items-center gap-3 px-4 py-3 font-semibold whitespace-nowrap transition-colors duration-300 border-b-4 ${
                    activeTab === tabName
                      ? 'border-blue-500 text-blue-600'
                      : 'border-transparent text-slate-500 hover:text-slate-800 hover:border-slate-300'
                  }`}
                  onClick={() => setActiveTab(tabName)}
                >
                  <div className={`w-2.5 h-2.5 rounded-full ${dotColor}`}></div>
                  <span>{tabName}</span>
                  <span className={`px-2.5 py-0.5 rounded-full text-xs font-bold ${
                    activeTab === tabName
                      ? 'bg-blue-100 text-blue-600'
                      : 'bg-slate-100 text-slate-500 group-hover:bg-slate-200'
                  }`}>
                    {getFilteredAssetsByTab(tabName).length}
                  </span>
                </button>
              );
            })}
          </div>
        </div>

        {/* BARU: Layout untuk Kontrol Tabel (Filter & Aksi) digabung di sini */}
        <div className="p-6 flex flex-col md:flex-row items-center justify-between gap-4">
          <div className="w-full md:w-auto flex-grow flex flex-col sm:flex-row items-center gap-4">
            {/* Search Input */}
            <div className="relative w-full flex-grow">
               <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                 <IconSearch className="w-5 h-5 text-slate-400" />
               </div>
               <input
                 type="text"
                 placeholder="Cari dalam tab ini..."
                 className="w-full pl-12 pr-4 py-3 bg-slate-50 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 outline-none text-slate-700 font-medium transition"
                 value={searchTerm}
                 onChange={(e) => setSearchTerm(e.target.value)}
               />
            </div>
            {/* Date Filter */}
            <input
              type="date"
              className="w-full sm:w-auto px-4 py-3 bg-slate-50 border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 outline-none text-slate-700 font-medium transition"
              value={selectedDate}
              onChange={(e) => setSelectedDate(e.target.value)}
              title="Filter berdasarkan tanggal perolehan"
            />
          </div>
          {/* Download Button */}
          <button
            onClick={downloadReport}
            className="group w-full md:w-auto flex items-center justify-center gap-3 px-5 py-3 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white rounded-xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-green-500/30 hover:scale-105"
          >
            <IconDownload className="w-5 h-5"/>
            <span>Unduh Laporan</span>
          </button>
        </div>

        {/* Content Area */}
        <div className="px-6 pb-6">
          {assetsToDisplay.length === 0 ? (
            <div className="text-center py-16 border-2 border-dashed border-slate-200 rounded-2xl">
              <div className="inline-flex p-6 bg-slate-100 rounded-3xl mb-4">
                <svg className="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
              </div>
              <p className="text-slate-500 text-lg font-medium">Tidak ada aset yang cocok</p>
              <p className="text-slate-400">Coba ubah filter atau kategori untuk melihat data</p>
            </div>
          ) : (
            <div className="overflow-hidden rounded-2xl border border-slate-200/80 shadow-md">
              <div className="overflow-x-auto">
                <table className="min-w-full bg-white">
                  <thead className="bg-slate-50 border-b border-slate-200">
                    <tr>
                      {['Kode', 'Nama Aset', 'Lokasi', 'Tanggal', 'Status', 'Aksi'].map((header) => (
                        <th key={header} className="px-6 py-4 text-left font-bold text-slate-600 text-sm uppercase tracking-wider">{header}</th>
                      ))}
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-slate-100">
                    {assetsToDisplay.map((asset) => (
                      <tr key={asset.id} className="hover:bg-blue-50/50 transition-colors duration-200">
                        <td className="px-6 py-4"><span className="px-3 py-1 bg-slate-100 text-slate-600 text-sm font-medium rounded-full">{asset.kodeAset}</span></td>
                        <td className="px-6 py-4">
                          <div className="flex items-center gap-3">
                            {/* DIUBAH: Warna titik status disederhanakan */}
                            <div className={`w-2.5 h-2.5 rounded-full ${
                              asset.status === 'Menunggu Persetujuan' ? 'bg-amber-500' :
                              asset.status === 'Disetujui' ? 'bg-green-500' : 'bg-red-500'
                            }`}></div>
                            <span className="font-semibold text-slate-800">{asset.namaAset}</span>
                          </div>
                        </td>
                        <td className="px-6 py-4 text-slate-500">{asset.lokasi}</td>
                        <td className="px-6 py-4 text-slate-500">{asset.tanggal}</td>
                        <td className="px-6 py-4">
                          {/* DIUBAH: Warna pill dan teks status disederhanakan dan disesuaikan */}
                          <span className={`px-3 py-1.5 inline-flex text-xs leading-tight font-bold rounded-full ${
                            asset.status === 'Menunggu Persetujuan' ? 'bg-amber-100 text-amber-700' :
                            asset.status === 'Disetujui' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
                          }`}>
                            {
                              asset.status === 'Menunggu Persetujuan' ? 'Belum Diverifikasi' :
                              asset.status === 'Disetujui' ? 'Terverifikasi' : 'Ditolak'
                            }
                          </span>
                        </td>
                        <td className="px-6 py-4">
                          <button onClick={() => handleLihatDetail(asset)} className="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm font-semibold rounded-xl transition shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30">
                            Detail
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Modal for Asset Detail */}
      {selectedAssetDetail && (
        <Modal onClose={() => setSelectedAssetDetail(null)} title="Detail Aset Dilaporkan" size="max-w-2xl">
          <div className="p-8">
            <button onClick={() => setSelectedAssetDetail(null)} className="absolute top-4 right-4 text-slate-400 hover:text-slate-600">
              <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            <div className="text-center mb-6">
              <h3 className="text-2xl font-bold text-slate-800">Detail Aset Dilaporkan</h3>
            </div>
            <div className="bg-slate-50 rounded-2xl p-6 space-y-4 border border-slate-200">
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                <div>
                  <p className="text-sm font-bold text-slate-600 mb-1">Kode Aset</p>
                  <p className="text-slate-800 font-semibold">{selectedAssetDetail.kodeAset}</p>
                </div>
                <div>
                  <p className="text-sm font-bold text-slate-600 mb-1">Nama Aset</p>
                  <p className="text-slate-800 font-semibold">{selectedAssetDetail.namaAset}</p>
                </div>
                <div>
                  <p className="text-sm font-bold text-slate-600 mb-1">Lokasi</p>
                  <p className="text-slate-800 font-semibold">{selectedAssetDetail.lokasi}</p>
                </div>
                <div>
                  <p className="text-sm font-bold text-slate-600 mb-1">Tanggal</p>
                  <p className="text-slate-800 font-semibold">{selectedAssetDetail.tanggal}</p>
                </div>
                <div className="sm:col-span-2">
                  <p className="text-sm font-bold text-slate-600 mb-1">Status</p>
                  {/* DIUBAH: Warna pill dan teks status di modal juga disesuaikan */}
                  <span className={`inline-flex px-3 py-1.5 text-sm font-semibold rounded-full ${
                    selectedAssetDetail.status === 'Menunggu Persetujuan' ? 'bg-amber-100 text-amber-700' :
                    selectedAssetDetail.status === 'Disetujui' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
                  }`}>
                    {
                      selectedAssetDetail.status === 'Menunggu Persetuju' ? 'Belum Diverifikasi' :
                      selectedAssetDetail.status === 'Disetujui' ? 'Terverifikasi' : 'Ditolak'
                    }
                  </span>
                </div>
              </div>
              <div className="pt-4 border-t border-slate-200">
                <p className="text-sm font-bold text-slate-600 mb-2">Alasan</p>
                <p className="text-slate-700">{selectedAssetDetail.alasan}</p>
              </div>
            </div>
            <div className="flex justify-end mt-8">
              <button onClick={() => setSelectedAssetDetail(null)} className="px-8 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold rounded-xl transition">
                Tutup
              </button>
            </div>
          </div>
        </Modal>
      )}
    </div>
  </div>
);
        }
        function SettingsContent({ setMessage }) {
            const [users, setUsers] = useState(getStoredUsers());
            const [editingUser, setEditingUser] = useState(null);
            const [formName, setFormName] = useState('');
            const [formEmail, setFormEmail] = useState('');
            const [formPassword, setFormPassword] = useState('');
            const [formRole, setFormRole] = useState('user');
            const [formPosition, setFormPosition] = useState(''); 

            useEffect(() => { /* Initial users load handled by useState default */ }, []);

            const resetForm = () => {
                setEditingUser(null); setFormName(''); setFormEmail(''); setFormPassword(''); setFormRole('user'); setFormPosition('');
            };

            const handleAddOrUpdateUser = async () => {
                if (!formEmail || !formPassword || !formName) { setMessage('Nama, Email, dan Password tidak boleh kosong.'); return; }
                try {
                    const userPayload = { 
                        email: formEmail, 
                        password: formPassword, 
                        role: formRole, 
                        name: formName, 
                        position: formPosition || (formRole === 'admin' ? 'Administrator Sistem' : 'Staff'),
                        avatarUrl: editingUser?.avatarUrl || `https://placehold.co/100x100/${Math.floor(Math.random()*16777215).toString(16)}/FFFFFF?text=${formName.substring(0,2).toUpperCase()}`
                    };
                    
                    let currentUsers = getStoredUsers();
                    if (editingUser) { 
                        currentUsers = currentUsers.map(u => u.email === editingUser.email ? {...editingUser, ...userPayload} : u);
                    } else { 
                        if (currentUsers.some(u => u.email === userPayload.email)) {
                            setMessage("Email sudah terdaftar. Gunakan email lain."); return;
                        }
                        currentUsers.push(userPayload);
                    }
                    saveUsers(currentUsers); 
                    setUsers(currentUsers); 
                    setMessage(editingUser ? 'Data pengguna berhasil diperbarui!' : 'Pengguna baru berhasil ditambahkan!');
                    resetForm();
                } catch (error) {
                    setMessage(error.message || "Gagal menyimpan data pengguna.");
                }
            };

            const handleDeleteUser = async (emailToDelete) => {
                // Menggunakan Modal kustom sebagai pengganti window.confirm
                // Untuk implementasi penuh, Anda perlu state untuk menampilkan modal konfirmasi ini.
                // Di sini, saya akan langsung proses seolah-olah dikonfirmasi.
                const confirmDelete = true; // Ganti dengan logika modal konfirmasi
                if (confirmDelete) {
                    try {
                        let currentUsers = getStoredUsers();
                        currentUsers = currentUsers.filter(u => u.email !== emailToDelete);
                        saveUsers(currentUsers);
                        setUsers(currentUsers);
                        setMessage(`Pengguna ${emailToDelete} berhasil dihapus.`);
                    } catch (error) {
                        setMessage("Gagal menghapus pengguna.");
                    }
                }
            };

            const startEditUser = (user) => {
                setEditingUser(user);
                setFormName(user.name);
                setFormEmail(user.email);
                setFormPassword(user.password); 
                setFormRole(user.role);
                setFormPosition(user.position);
            };

            return (
                <div className="p-4 sm:p-6 md:p-8 space-y-8">
                    <h1 className="text-2xl sm:text-3xl font-bold text-main">Pengaturan Aplikasi</h1>
                    <p className="text-subtle">Kelola pengguna aplikasi dan preferensi lainnya.</p>
                    
                    <div className="bg-card p-4 sm:p-6 rounded-xl shadow-custom border border-soft">
                        <h3 className="text-xl font-semibold text-main mb-2">Manajemen Pengguna</h3>
                        <p className="text-sm text-muted mb-6">Tambah, edit, atau hapus akun pengguna. Data disimpan di LocalStorage.</p>
                        
                        <div className="mb-8 p-5 border border-soft rounded-lg bg-surface">
                            <h4 className="text-lg font-medium text-main mb-4">{editingUser ? 'Edit Data Pengguna' : 'Tambah Pengguna Baru'}</h4>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                <div><label htmlFor="userName" className="block text-subtle text-sm font-medium mb-1.5">Nama Lengkap</label><input type="text" id="userName" className="w-full text-sm" value={formName} onChange={(e) => setFormName(e.target.value)} placeholder="Nama Pengguna"/></div>
                                <div><label htmlFor="userEmail" className="block text-subtle text-sm font-medium mb-1.5">Alamat Email</label><input type="email" id="userEmail" className="w-full text-sm" value={formEmail} onChange={(e) => setFormEmail(e.target.value)} disabled={!!editingUser} placeholder="email@example.com"/></div>
                                <div><label htmlFor="userPassword" className="block text-subtle text-sm font-medium mb-1.5">Password</label><input type="password" id="userPassword" className="w-full text-sm" value={formPassword} onChange={(e) => setFormPassword(e.target.value)} placeholder={editingUser ? "Kosongkan jika tidak ingin ganti" : "Password baru"}/></div>
                                <div><label htmlFor="userPosition" className="block text-subtle text-sm font-medium mb-1.5">Jabatan</label><input type="text" id="userPosition" className="w-full text-sm" value={formPosition} onChange={(e) => setFormPosition(e.target.value)} placeholder="Contoh: Staff Keuangan"/></div>
                                <div className="md:col-span-2"><label htmlFor="userRole" className="block text-subtle text-sm font-medium mb-1.5">Peran (Role)</label><select id="userRole" className="w-full text-sm" value={formRole} onChange={(e) => setFormRole(e.target.value)}><option value="user">User</option><option value="admin">Admin</option></select></div>
                            </div>
                            <div className="flex justify-end space-x-3 mt-6">
                                {editingUser && (<button onClick={resetForm} className="button-base button-secondary text-sm py-2 px-3">Batal Edit</button>)}
                                <button onClick={handleAddOrUpdateUser} className="button-base button-primary text-sm py-2 px-3">{editingUser ? 'Simpan Perubahan' : 'Tambah Pengguna'}</button>
                            </div>
                        </div>

                        <h3 className="text-xl font-semibold text-main mb-4">Daftar Pengguna Terdaftar</h3>
                        {users.length === 0 ? <p className="text-subtle text-center py-4">Tidak ada pengguna terdaftar.</p> : (
                            <div className="overflow-x-auto table-container">
                                <table className="min-w-full divide-y divide-soft">
                                    <thead className="bg-surface">
                                        <tr>
                                            <th className="table-header-cell">Nama</th>
                                            <th className="table-header-cell">Email</th>
                                            <th className="table-header-cell">Jabatan</th>
                                            <th className="table-header-cell">Peran</th>
                                            <th className="table-header-cell">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-card divide-y divide-soft">
                                        {users.map(user => (
                                            <tr key={user.email} className="table-body-row">
                                                <td className="table-body-cell font-medium">{user.name}</td>
                                                <td className="table-body-cell">{user.email}</td>
                                                <td className="table-body-cell">{user.position}</td>
                                                <td className="table-body-cell capitalize">{user.role}</td>
                                                <td className="table-body-cell font-medium">
                                                    <button onClick={() => startEditUser(user)} className="text-accent-primary-light dark:text-accent-primary-dark hover:underline mr-4 transition-colors">Edit</button>
                                                    <button onClick={() => handleDeleteUser(user.email)} className="text-red-500 hover:text-red-600 transition-colors">Hapus</button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                    <div className="bg-card p-6 rounded-xl shadow-custom border border-soft">
                        <h3 className="text-xl font-semibold text-main mb-3">Preferensi Aplikasi</h3>
                        <p className="text-subtle">Pengaturan tambahan akan tersedia di sini di masa mendatang.</p>
                         <div className="mt-4">
                            <h4 className="text-md font-medium text-main mb-2">Pengaturan API Key (Contoh)</h4>
                            <p className="text-xs text-muted mb-1">API Key untuk layanan eksternal (misal: Gemini AI) idealnya dikelola di backend.</p>
                            <p className="text-xs text-muted mb-2">Untuk aplikasi client-side murni, jika harus ada, pastikan Anda memahami risiko keamanannya.</p>
                            <input 
                                type="text" 
                                placeholder="Masukkan API Key di sini jika diperlukan" 
                                className="w-full max-w-md text-sm p-2 border border-soft rounded-md bg-surface"
                                // value={apiKeyFromSomewhere} 
                                // onChange={(e) => setApiKeyFromSomewhere(e.target.value)} 
                            />
                             <p className="text-xs text-red-500 mt-1">Jangan pernah hardcode API Key sensitif langsung di kode client-side untuk aplikasi produksi!</p>
                        </div>
                    </div>
                </div>
            );
        }


        // --- Komponen utama aplikasi ---
        function App() {
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [message, setMessage] = useState('');
            const [isDaftarAsetExpanded, setIsDaftarAsetExpanded] = useState(true); 
            const [showLogoutOptions, setShowLogoutOptions] = useState(false);
            const [showProfileEditModal, setShowProfileEditModal] = useState(false);
            const [isDarkMode, setIsDarkMode] = useState(() => { 
                const savedTheme = localStorage.getItem('themeV3'); 
                return savedTheme ? savedTheme === 'dark' : true; 
            }); 
            const [userProfile, setUserProfile] = useState(getProfile());
            const [showAiChatPanel, setShowAiChatPanel] = useState(false);
            const [isSidebarOpen, setIsSidebarOpen] = useState(true); 
            const pageKey = useRef(currentPage); 
            const pageNodeRef = useRef(null);


            useEffect(() => { saveProfile(userProfile); }, [userProfile]);
            useEffect(() => { 
                localStorage.setItem('themeV3', isDarkMode ? 'dark' : 'light'); 
                if (isDarkMode) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, [isDarkMode]);
            
            const navigateTo = (page) => { 
                pageKey.current = page + Date.now(); 
                setCurrentPage(page); 
                setMessage(''); 
                // Auto-expand "Manajemen Aset" if navigating to one of its sub-pages
                if (['daftarAset', 'pengajuanAset', 'barangKeluar', 'pelacakanAset'].includes(page)) {
                    setIsDaftarAsetExpanded(true);
                } else if (page !== 'daftarAsetMenu') { // Collapse if not navigating to the menu itself or its children
                    setIsDaftarAsetExpanded(false);
                }
            };
            const toggleDaftarAset = () => { 
                setIsDaftarAsetExpanded(!isDaftarAsetExpanded); 
                // If collapsing and current page is a sub-item, navigate to a default or parent page if desired
                // For now, it just collapses/expands
            };
            const handleLogoutOption = (option) => { setShowLogoutOptions(false); if (option === 'register') { window.location.href = './Register.html'; } else if (option === 'login') { window.location.href = './index.html'; }};
            const handleSaveProfile = (updatedProfile) => { setUserProfile(updatedProfile); setMessage('Profil berhasil diperbarui!'); };
            
            const handleSettingsAccess = () => { navigateTo('settings'); };

            const renderContent = () => {
                switch (currentPage) {
                    case 'dashboard': return <DashboardContent allAssets={getAssets()} />;
                    case 'daftarAset': return <DaftarAsetContent navigateTo={navigateTo} />;
                    case 'pengajuanAset': return <PengajuanAsetContent navigateTo={navigateTo} setMessage={setMessage} />;
                    case 'barangKeluar': return <BarangKeluarContent navigateTo={navigateTo} setMessage={setMessage} />;
                    case 'pelacakanAset': return <PelacakanAsetContent navigateTo={navigateTo} setMessage={setMessage} />;
                    case 'verifikasiAset': return <VerifikasiAsetContent navigateTo={navigateTo} setMessage={setMessage} />;
                    case 'laporan': return <LaporanContent navigateTo={navigateTo} setMessage={setMessage} />;
                    case 'settings': return <SettingsContent setMessage={setMessage} />;
                    default: return <DashboardContent allAssets={getAssets()} />;
                }
            };

            const menuItems = [
                { id: 'dashboard', label: 'Dashboard', icon: <IconDashboard /> },
                { id: 'daftarAsetMenu', label: 'Manajemen Aset', icon: <IconAssetList />, subItems: [ 
                    { id: 'daftarAset', label: 'Semua Aset', icon: <IconAssetList /> }, 
                    { id: 'pengajuanAset', label: 'Pengajuan Baru', icon: <IconPlus />, isAction: true }, // Mark as action for specific active style
                    { id: 'barangKeluar', label: 'Barang Keluar', icon: <IconArchiveBoxArrowDown />, isAction: true }, 
                    { id: 'pelacakanAset', label: 'Pelacakan & QR', icon: <IconMapPin />, isAction: true },
                ]},
                { id: 'verifikasiAset', label: 'Verifikasi', icon: <IconVerify /> },
                { id: 'laporan', label: 'Laporan', icon: <IconReport /> },
            ];
            const bottomMenuItems = [
                { id: 'settings', label: 'Pengaturan', icon: <IconSettings />, action: handleSettingsAccess },
                { id: 'logout', label: 'Keluar', icon: <IconLogout />, action: () => setShowLogoutOptions(true) },
            ];
            
            return (
                <AppContext.Provider value={{ isDarkMode, setIsDarkMode }}>
                    <div className={`flex min-h-screen bg-bg-primary font-inter text-text-primary`}>
                        {/* Sidebar */}
                        <div className={`sidebar w-64 p-5 flex flex-col justify-between transition-all duration-300 ease-in-out ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'}`}>
                            <div>
                                <div className="mb-8 flex items-center space-x-2.5 pt-1">
                                    <img src={userProfile.logoUrl} alt="Eminent Logo" className="h-8 object-contain"/>
                                </div>
                                <button 
                                    onClick={() => navigateTo('pengajuanAset')} 
                                    className="w-full button-base button-primary button-action text-sm mb-6 flex items-center justify-center"
                                > {/* Added button-action class */}
                                    <IconPlus /> <span className="ml-2">Buat Pengajuan</span>
                                </button>
                                <nav className="space-y-1">
                                    {menuItems.map(item => (
                                        <div key={item.id}>
                                            <a
                                                href="#"
                                                onClick={(e) => {
                                                    e.preventDefault();
                                                    if (item.action) item.action();
                                                    else if (item.subItems) toggleDaftarAset();
                                                    else navigateTo(item.id);
                                                }}
                                                className={`flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-150 ease-in-out sidebar-link text-sm font-medium ${
                                                    (currentPage === item.id || (item.id === 'daftarAsetMenu' && (currentPage === 'pengajuanAset' || currentPage === 'pelacakanAset' || currentPage === 'daftarAset' || currentPage === 'barangKeluar'))) 
                                                    ? 'sidebar-link-active' 
                                                    : 'text-text-secondary hover:text-text-primary hover:bg-bg-tertiary'
                                                } ${item.isAction ? 'action-link' : ''}`} // Added action-link for specific active style
                                            >
                                                {item.icon}
                                                <span>{item.label}</span>
                                                {item.subItems && (isDaftarAsetExpanded ? <IconChevronUp /> : <IconChevronDown />)}
                                            </a>
                                            {item.subItems && isDaftarAsetExpanded && (
                                                <ul className="mt-1 ml-3.5 pl-3.5 border-l border-border-soft space-y-0.5">
                                                    {item.subItems.map(subItem => (
                                                        <li key={subItem.id}>
                                                            <a href="#" onClick={(e) => { e.preventDefault(); navigateTo(subItem.id);}}
                                                                className={`flex items-center space-x-2.5 px-3 py-2 rounded-md text-xs+ transition-all duration-150 ease-in-out ${currentPage === subItem.id ? 'text-accent-primary-light dark:text-accent-primary-dark bg-bg-tertiary font-medium' : 'text-text-tertiary hover:text-accent-primary-light dark:hover:text-accent-primary-dark hover:bg-bg-tertiary'} ${subItem.isAction ? 'action-link' : ''}`}>
                                                                {subItem.icon}
                                                                <span>{subItem.label}</span>
                                                            </a>
                                                        </li>
                                                    ))}
                                                </ul>
                                            )}
                                        </div>
                                    ))}
                                </nav>
                            </div>
                            <nav className="space-y-1 pt-4 border-t border-border-soft">
                                {bottomMenuItems.map(item => (
                                    <a key={item.id} href="#" onClick={(e) => { e.preventDefault(); item.action();}}
                                        className={`flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-150 ease-in-out sidebar-link text-sm font-medium ${currentPage === item.id ? 'sidebar-link-active' : 'text-text-secondary hover:text-text-primary hover:bg-bg-tertiary'}`}>
                                        {item.icon}
                                        <span>{item.label}</span>
                                    </a>
                                ))}
                            </nav>
                        </div>

                        {/* Main Content Area */}
                        <div className="flex-1 flex flex-col overflow-hidden">
                            <header className="header p-4 md:px-6 md:py-4 flex items-center justify-between sticky top-0 z-40">
                               <div className="flex-1"></div>
                                <div className="flex items-center space-x-2 sm:space-x-3 ml-4">
                                    <button onClick={() => setIsDarkMode(!isDarkMode)} className="header-icon-button" title={isDarkMode ? "Mode Terang" : "Mode Gelap"}>
                                        {isDarkMode ? <IconSun /> : <IconMoon />}
                                    </button>
                                    <button className="relative header-icon-button" title="Notifikasi">
                                        <IconBell />
                                        <span className="absolute top-1.5 right-1.5 block h-2 w-2 rounded-full bg-red-500 ring-1 ring-offset-1 ring-offset-card ring-red-500 animate-pulse"></span>
                                    </button>
                                    <div className="cursor-pointer header-avatar" onClick={() => setShowProfileEditModal(true)} title="Profil Pengguna">
                                        <img src={userProfile.avatarUrl} alt={userProfile.name} className="w-8 h-8 sm:w-9 sm:h-9 rounded-full object-cover border-2 border-transparent transition-all" onError={(e)=>{e.target.onerror=null;e.target.src='https://placehold.co/40x40/FF8C42/FFFFFF?text=U'}} />
                                    </div>
                                </div>
                            </header>
                            <main className="flex-1 overflow-y-auto bg-bg-primary page-container">
                                <TransitionGroup component={null}>
                                    <CSSTransition
                                        key={pageKey.current} 
                                        nodeRef={pageNodeRef} 
                                        timeout={300}
                                        classNames="page-content"
                                        unmountOnExit
                                    >
                                        <div className="page-wrapper" ref={pageNodeRef}> 
                                            {renderContent()}
                                        </div>
                                    </CSSTransition>
                                </TransitionGroup>
                            </main>
                             <div id="aiAssistantFab" title="AI Assistant">
        <i class="fas fa-robot"></i>
    </div>

    <div id="aiChatWindow" class="hidden"> 
        <div id="aiChatHeader">
            <span>EMINENT AI</span>
            <button id="closeAiChatBtn" title="Tutup Chat"><i class="fas fa-times"></i></button>
        </div>
        <div id="aiChatMessages">
            </div>
        <div id="aiQuickActions">
            <button id="getSecurityTipsBtn" class="ai-quick-action-btn">
                <i class="fas fa-shield-alt"></i>
                <span>Tips Keamanan</span>
            </button>
            </div>
        <div id="aiChatInputArea">
            <input type="text" id="aiChatMessageInput" placeholder="Tulis pesan Anda..." />
            <button id="sendAiChatMessageBtn" title="Kirim Pesan"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

                        </div>
                        
                        {/* Floating AI Button */}
                        <button 
                            onClick={() => setShowAiChatPanel(true)} 
                            className="floating-ai-button"
                            title="Buka Asisten AI"
                        >
                            <IconRobotFace />
                        </button>

                        <AiChatInterface isOpen={showAiChatPanel} onClose={() => setShowAiChatPanel(false)} />

                        <MessageBox message={message} onClose={() => setMessage('')} />
                        {showLogoutOptions && <LogoutOptionsModal onSelectOption={handleLogoutOption} onClose={() => setShowLogoutOptions(false)} />}
                        {showProfileEditModal && <ProfileEditModal userProfile={userProfile} onSave={handleSaveProfile} onClose={() => setShowProfileEditModal(false)} setMessage={setMessage} />}
                    </div>
                </AppContext.Provider>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
